---
title: "Replication package-RSiena"
author: '[Jochem Tolsma](https://www.jochemtolsma.nl) - Radboud University / University of Groningen, the Netherlands'
bibliography: references.bib
date: "Last compiled on `r format(Sys.time(), '%B, %Y')`"
output: 
  html_document:
    toc:  true
    toc_float: true
    number_sections: false
    code_folding: hide
    code_download: yes
---


```{r globalsettings, echo=FALSE, warning=FALSE, message=FALSE, results='hide'}
library(knitr)
opts_chunk$set(tidy.opts=list(width.cutoff=100),tidy=TRUE, warning = FALSE, message = FALSE,comment = "#>", cache=TRUE, echo=FALSE, eval=FALSE, class.source=c("test"), class.output=c("test2"))
options(width = 100)
rgl::setupKnitr()
```

```{r colorize, echo=FALSE, eval=TRUE}
colorize <- function(x, color) {
  if (knitr::is_latex_output()) {
    sprintf("\\textcolor{%s}{%s}", color, x)
  } else if (knitr::is_html_output()) {
    sprintf("<span style='color: %s;'>%s</span>", color, 
            x)
  } else x
}

```

```{r klippy, echo=FALSE, include=TRUE, eval=TRUE}
klippy::klippy(position = c('top', 'right'))
#klippy::klippy(color = 'darkred')
#klippy::klippy(tooltip_message = 'Click to copy', tooltip_success = 'Done')
```

```{css, echo=FALSE}
pre.test {
  max-height: 300px;
  overflow-y: auto;
  overflow-x: auto;
  margin: 0px;
}

pre.test2 {
  max-height: 300px;
  overflow-y: auto;
  overflow-x: auto;
  margin: 0px;
  background-color: white;
  color: rgb(201, 76, 76);
}


h1, .h1, h2, .h2, h3, .h3 {
  margin-top: 24px;
}


```


---  

# Intro  


This [website](https://jochemtolsma.github.io/Twitter/) is a replication package for the paper "**Twitter and divides in the Dutch Parliament: Social and Political Segregation in the following, @-mentions and retweets networks**" by @Tolsma2021.

It contains R code to replicate all Tables/Figures/Appendix in the manuscript.

To copy the code click the button in the upper right corner of the code-chunks.

Use the top menu to navigate to the section of interest. 

The source code of this website can be found on [Github](https://github.com/JochemTolsma/Twitter)

Questions can be addressed to [Jochem Tolsma](mailto:jochem.tolsma@ru.nl).

---  

## Packages  

```{r packages, echo=TRUE, message=FALSE, warning=FALSE, eval=TRUE}
#install if necessary 
if (!require("tidyverse", character.only = TRUE)) {install.packages("tidyverse", dependencies=TRUE)}
if (!require("dplyr", character.only = TRUE)) {install.packages("dplyr", dependencies=TRUE)}
if (!require("foreign", character.only = TRUE)) {install.packages("foreign", dependencies=TRUE)}
if (!require("igraph", character.only = TRUE)) {install.packages("igraph", dependencies=TRUE)}
if (!require("knitr", character.only = TRUE)) {install.packages("knitr", dependencies=TRUE)}
if (!require("kableExtra", character.only = TRUE)) {install.packages("kableExtra", dependencies=TRUE)}
if (!require("RSiena", character.only = TRUE)) {install.packages("RSiena", dependencies=TRUE)}
if (!require("haven", character.only = TRUE)) {install.packages("haven", dependencies=TRUE)}

#load packages.
library(tidyverse)
library(dplyr)
library(foreign)
library(igraph)
library(knitr)
library(kableExtra)
library(RSiena)
library(haven)

```


---   



## Custom functions: tweaking output


```{r, echo=TRUE, eval=TRUE}
fanscsv <- function(ans = ans) {
  ans1_mat <- matrix(NA, nrow = length(ans$effects[, 2]), ncol = 3)
  row.names(ans1_mat) <- ans$effects[, 2]
  ans1_mat[, 1] <- (ans$theta)
  ans1_mat[, 2] <- (ans$se)
  ans1_mat[, 3] <- (ans$tconv)
  ans1_mat <- rbind(ans1_mat, c(ans$tconv.max))
  row.names(ans1_mat)[length(row.names(ans1_mat))] <- "Overall maximum convergence ratio:"
  colnames(ans1_mat) <- c("Estimate", "Standard Error", "Convergence t-ratio")
  return(ans1_mat)
  # print(ans1_mat)
  # write.csv(ans1_mat, filename)
}

```

---  

## Load data objects {.tabset .tabset-fade}  


Data objects:  

- [key](./data-processed/key moederbestand 20171114.sav): information on all politicians on election list  
- [twitter](./data-processed/twitter_20190919.RData)  
    - keyf: information on all 147 MPs with twitter handle  
    - mydata: RSiena object with all kind of goodies inside  
    - seats: seating coordinates of HoP (used for plotting)  
    

```{r data, echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
#STAP 1: read in data
key <- read.spss('data-processed\\key moederbestand 20171114.sav', use.value.labels=T, to.data.frame=T)


load("data-processed\\twitter_20190919.RData")
#str(twitter_20190919,1)
keyf <- twitter_20190919[[1]]
mydata <- twitter_20190919[[2]]
seats <- twitter_20190919[[3]]


#construct two separate datasets for each period. NOT USED IN MANUSCRIPT
deps <- mydata$depvars
covariates <- mydata$cCovars
codyadcovar <- mydata$dycCovars

fnet <- sienaNet(deps$fnet[,,1:2]) 
atmnet <- sienaNet(deps$atmnet[,,1:2])
rtnet <- sienaNet(deps$rtnet[,,1:2])
afstand <- codyadcovar$afstand
egohandle <- covariates$egohandle
egoid <- covariates$egoid
partij <- covariates$partij
coalitie <- covariates$coalitie
cda <- covariates$cda
cu <- covariates$cu
denk <- covariates$denk
d66 <- covariates$d66
fvd <- covariates$fvd
gl <- covariates$gl
pvda <- covariates$pvda
pvdd <- covariates$pvdd
pvv <- covariates$pvv
sgp <- covariates$sgp
sp <- covariates$sp
vvd <- covariates$vvd
plus <- covariates$plus
ethminz <- covariates$ethminz
vrouw <- covariates$vrouw
lft <- covariates$lft
kamerlid2016 <- covariates$kamerlid2016
kabinet2016 <- covariates$kabinet2016
pleklijst <- covariates$pleklijst
pleklijst1 <- covariates$pleklijst1

mydata12 <- sienaDataCreate(fnet,
                          atmnet, 
                          rtnet, 
                          afstand, 
                          egohandle, 
                          egoid, 
                          partij, 
                          coalitie, 
                          cda,
                          cu,
                          denk,
                          d66,
                          fvd,
                          gl,
                          pvda,
                          pvdd,
                          pvv,
                          sgp,
                          sp,
                          vvd,
                          plus, 
                          ethminz,
                          vrouw,
                          lft,
                          kamerlid2016,
                          kabinet2016,
                          pleklijst,
                          pleklijst1)

fnet <- sienaNet(deps$fnet[,,2:3]) 
atmnet <- sienaNet(deps$atmnet[,,2:3])
rtnet <- sienaNet(deps$rtnet[,,2:3])

mydata23 <- sienaDataCreate(fnet,
                          atmnet, 
                          rtnet, 
                          afstand, 
                          egohandle, 
                          egoid, 
                          partij, 
                          coalitie, 
                          cda,
                          cu,
                          denk,
                          d66,
                          fvd,
                          gl,
                          pvda,
                          pvdd,
                          pvv,
                          sgp,
                          sp,
                          vvd,
                          plus, 
                          ethminz,
                          vrouw,
                          lft,
                          kamerlid2016,
                          kabinet2016,
                          pleklijst,
                          pleklijst1)


```

---  

# Estimate RSiena models  {.tabset .tabset-fade} 

## Model 0 {.tabset .tabset-fade} 

### Basic structural effects only.  


Included effects:  

- three dependent network variables  
- degree (once without and once with time heterogeneity)  
- reciprocity  
- indegree-popularity (sqrt)  
- outdegree-activity (sqrt)  
- outdegree-popularity (sqrt)  
- transitive triplets or GWESPP  
- shared popularity

```{r structural model, echo=TRUE}
#print01Report( mydata, modelname="Twitter")
#let us have a look at all possible effects
#effectsDocumentation()

# Define the model
# 
# We will compare a model with *transTrip* versus *gwespFF* first. 


myeff <- getEffects( mydata )
myeff_m1 <- myeff

#according to suggestion of rsiena manual
myeff_m1 <- includeEffects( myeff_m1, inPopSqrt, name="fnet" )
myeff_m1 <- includeEffects( myeff_m1, inPopSqrt, name="atmnet" )
myeff_m1 <- includeEffects( myeff_m1, inPopSqrt, name="rtnet" )

myeff_m1 <- includeEffects( myeff_m1, outActSqrt, name="fnet" )
myeff_m1 <- includeEffects( myeff_m1, outActSqrt, name="atmnet" )
myeff_m1 <- includeEffects( myeff_m1, outActSqrt, name="rtnet" )

myeff_m1 <- includeEffects( myeff_m1, outPopSqrt, name="fnet" )
myeff_m1 <- includeEffects( myeff_m1, outPopSqrt, name="atmnet" )
myeff_m1 <- includeEffects( myeff_m1, outPopSqrt, name="rtnet" )

myeff_m1 <- includeEffects( myeff_m1, transTrip, name="fnet" )
myeff_m1 <- includeEffects( myeff_m1, transTrip, name="atmnet" )
myeff_m1 <- includeEffects( myeff_m1, transTrip, name="rtnet" )

#myeff_m1 <- includeEffects( myeff_m1, cycle3, name="fnet" )
#myeff_m1 <- includeEffects( myeff_m1, cycle3, name="atmnet" )
#myeff_m1 <- includeEffects( myeff_m1, cycle3, name="rtnet" )


#estimates
myalgorithm <- sienaAlgorithmCreate( projname = 'M1')
ansM1 <- siena07( myalgorithm, data = mydata, effects = myeff_m1, useCluster=TRUE, nbrNodes=4, initC=TRUE, batch=TRUE)
ansM1

ansM1b <- siena07( myalgorithm, data = mydata, prevAns=ansM1, effects = myeff_m1, useCluster=TRUE, nbrNodes=8, initC=TRUE, batch=TRUE)

#ansM1b ##good fit. 

#save(ansM1b, file=paste("ansM1b",".RData",sep=""))

```

```{r, eval=TRUE}
load("ansM1b.RData")
ansM1b
```

---  

### Time heterogeneity in outdegree. 



```{r}
### time heterogeneity in outdegree  


#load("ansM1b.RData")
#myeff_m1 <- ansM1b$effects #this does not work with time dummies

myeff_m1
myeff_m1_td <- includeTimeDummy(myeff_m1, density, name="atmnet", timeDummy="2")
myeff_m1_td <- includeTimeDummy(myeff_m1_td, density, name="rtnet", timeDummy="2")


ansM2 <- siena07( myalgorithm, data = mydata, prevAns=ansM1b, effects = myeff_m1_td, useCluster=TRUE, nbrNodes=8, initC=TRUE, batch=TRUE)
#ansM2 
#save(ansM2, file=paste("ansM2",".RData",sep=""))

ansM2b <- siena07( myalgorithm, data = mydata, prevAns=ansM2, effects = myeff_m1_td, useCluster=TRUE, nbrNodes=8, initC=TRUE, batch=TRUE)
#ansM2b 
#save(ansM2b, file=paste("ansM2b",".RData",sep=""))

```

```{r, eval=TRUE}
load("ansM2b.RData")
ansM2b
```

`r colorize("Interpretation:", "red")`

Please be aware that we are looking at period interactions: 

- atmention degrees decreased faster in period 2 than in period 1, hence negative interaction  
- retweet degrees decreased faster in period 1 than in period 2, hence positive interaction  


---  

### gwespFF versus transTrip 


```{r, eval=FALSE, echo=TRUE}
myeff <- getEffects( mydata )
myeff_m1b <- myeff

#according to suggestion of rsiena manual
myeff_m1b <- includeEffects( myeff_m1b, inPopSqrt, name="fnet" )
myeff_m1b <- includeEffects( myeff_m1b, inPopSqrt, name="atmnet" )
myeff_m1b <- includeEffects( myeff_m1b, inPopSqrt, name="rtnet" )

myeff_m1b <- includeEffects( myeff_m1b, outActSqrt, name="fnet" )
myeff_m1b <- includeEffects( myeff_m1b, outActSqrt, name="atmnet" )
myeff_m1b <- includeEffects( myeff_m1b, outActSqrt, name="rtnet" )

myeff_m1b <- includeEffects( myeff_m1b, outPopSqrt, name="fnet" )
myeff_m1b <- includeEffects( myeff_m1b, outPopSqrt, name="atmnet" )
myeff_m1b <- includeEffects( myeff_m1b, outPopSqrt, name="rtnet" )

myeff_m1b <- includeEffects( myeff_m1b, gwespFF, name="fnet" )
myeff_m1b <- includeEffects( myeff_m1b, gwespFF, name="atmnet" )
myeff_m1b <- includeEffects( myeff_m1b, gwespFF, name="rtnet" )

myeff_m3 <- myeff_m1b

myalgorithm <- sienaAlgorithmCreate( projname = 'M1')
ansM3 <- siena07( myalgorithm, data = mydata, effects = myeff_m3, useCluster=TRUE, nbrNodes=8, initC=TRUE, batch=TRUE)
#ansM3
#save(ansM3, file=paste("ansM3",".RData",sep=""))

ansM3b <- siena07( myalgorithm, data = mydata, prevAns=ansM3, effects = myeff_m1, useCluster=TRUE, nbrNodes=8, initC=TRUE, batch=TRUE)
#ansM3b  
#save(ansM3b, file=paste("ansM3b",".RData",sep=""))

```

```{r, eval=TRUE}
load("ansM3.RData")
#ansM3

res <- round(fanscsv(ansM3)[-25,1:2],5)
mc <- as.character(round(fanscsv(ansM3)[25,1],3))
row.names(res) <- c(
 "rate 1"  ,      
 "rate 2"   ,     
 "outdegree"          ,  
 "reciprocity"         ,           
 "GWESP"  ,          
 "indegree - popularity (sqrt)"   ,
  "outdegree - popularity (sqrt)" , 
 "outdegree - activity (sqrt)"    ,
 "rate 1"  ,      
 "rate 2"   ,     
 "outdegree"          ,  
 "reciprocity"         ,           
 "GWESP"  ,          
 "indegree - popularity (sqrt)"   ,
  "outdegree - popularity (sqrt)" , 
 "outdegree - activity (sqrt)"    ,
 "rate 1"  ,      
 "rate 2"   ,     
 "outdegree"          ,  
 "reciprocity"         ,           
 "GWESP"  ,          
 "indegree - popularity (sqrt)"   ,
  "outdegree - popularity (sqrt)" , 
 "outdegree - activity (sqrt)"    
)
  
RR2_gwesp <- kbl(res, booktabs=TRUE, digits=3, caption="GWESP", align = "c") %>%
  kable_classic(full_width = F, html_font = "Cambria") %>%
  kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive")) %>%
  column_spec(column = 1, width = "3in")   %>%
  group_rows(index = c("Following" = 8, "Atmention" = 8, "Retweets" = 8)) %>%
  footnote(general = paste("Overall maximum convergence ratio: ", mc, sep="" ))


RR2_gwesp

```


Don't think it will matter much whether we include gwespFF or TranTrip. 

---  


### Model 0 - final {.active}

Finally, we also included sharedPop to reach Model 0


```{r, echo=TRUE}
myeff <- getEffects( mydata )
myeff_m1 <- myeff

#according to suggestion of rsiena manual
myeff_m1 <- includeEffects( myeff_m1, inPopSqrt, name="fnet" )
myeff_m1 <- includeEffects( myeff_m1, inPopSqrt, name="atmnet" )
myeff_m1 <- includeEffects( myeff_m1, inPopSqrt, name="rtnet" )

myeff_m1 <- includeEffects( myeff_m1, outActSqrt, name="fnet" )
myeff_m1 <- includeEffects( myeff_m1, outActSqrt, name="atmnet" )
myeff_m1 <- includeEffects( myeff_m1, outActSqrt, name="rtnet" )

myeff_m1 <- includeEffects( myeff_m1, outPopSqrt, name="fnet" )
myeff_m1 <- includeEffects( myeff_m1, outPopSqrt, name="atmnet" )
myeff_m1 <- includeEffects( myeff_m1, outPopSqrt, name="rtnet" )

myeff_m1 <- includeEffects( myeff_m1, transTrip, name="fnet" )
myeff_m1 <- includeEffects( myeff_m1, transTrip, name="atmnet" )
myeff_m1 <- includeEffects( myeff_m1, transTrip, name="rtnet" )

myeff_m1 <- includeEffects( myeff_m1, sharedPop, name="fnet" )
myeff_m1 <- includeEffects( myeff_m1, sharedPop, name="atmnet" )
myeff_m1 <- includeEffects( myeff_m1, sharedPop, name="rtnet" )


load("ansM1b.RData")

ansM4 <- siena07( myalgorithm, data = mydata, prevAns=ansM1b, effects = myeff_m1, useCluster=TRUE, nbrNodes=8, initC=TRUE, batch=TRUE)
ansM4 
save(ansM4, file=paste("ansM4",".RData",sep=""))

ansM4b <- siena07( myalgorithm, data = mydata, prevAns=ansM4, effects = myeff_m1, useCluster=TRUE, nbrNodes=8, initC=TRUE, batch=TRUE)
ansM4b
save(ansM4b, file=paste("ansM4b",".RData",sep=""))

```

```{r, eval=TRUE}
load("ansM4b.RData")
ansM4b
```

----  

## Model 1 {.tabset .tabset-fade}

Baseline model with controls to test Hypothesis 1.  

### Relevant party dummies  

We cannot include all party dummies as covariates for ego and alter. We will thus first check which party deviates significantly with respect to indegree and outdegree. 

First the descriptives. 

```{r, echo=TRUE, eval=TRUE}
#check if we observe outdegree differences per partij
fnet <- mydata$depvars$fnet
atmnet <- mydata$depvars$atmnet
rtnet <- mydata$depvars$rtnet
testfnet <- fnet[,,1]
testfnet[testfnet==10] <- NA
testrtnet <- rtnet[,,1]
testrtnet[testrtnet==10] <- NA
testatmnet <- atmnet[,,1]
testatmnet[testatmnet==10] <- NA

keyf$outdegreesf <- rowSums(testfnet, na.rm=TRUE)
keyf$indegreesf <- colSums(testfnet, na.rm=TRUE)

keyf$outdegreesrt <- rowSums(testrtnet, na.rm=TRUE)
keyf$indegreesrt <- colSums(testrtnet, na.rm=TRUE)

keyf$outdegreesatm <- rowSums(testatmnet, na.rm=TRUE)
keyf$indegreesatm <- colSums(testatmnet, na.rm=TRUE)


degreesum <- keyf %>% 
  group_by(Partij) %>%
  summarize(mean_of= mean(outdegreesf, na.rm=T),
            mean_if= mean(indegreesf, na.rm=T),
            mean_irt= mean(outdegreesrt, na.rm=T),
            mean_ort= mean(indegreesrt, na.rm=T),
            mean_iat= mean(outdegreesatm, na.rm=T),
            mean_oat= mean(indegreesatm, na.rm=T),
            count= n()) %>%
  arrange(desc(count)) %>%
  select(!("count"))


colnames(degreesum) <- c("Party", "outdegree friends", "indegree friends", "outdegree retweets", "indegree retweets", "outdegree atmentions", "indegree atmentions")


#write_csv(degreesum, "degreesum.csv")
```

```{r, eval=TRUE}

degreesum <- read.csv("degreesum.csv")
degreesum <- kbl(degreesum, booktabs=TRUE, digits=2, caption="mean degree by party", align = "c") %>%
  kable_classic(full_width = F, html_font = "Cambria") %>%
  kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive")) 

scroll_box(degreesum, width="100%", height="500px")

```

Let us use a simple OLS regression with deviation coding (grand mean is ref) to test for significance.

```{r, echo=TRUE, eval=TRUE, results="hold"}

keyf$Partij2 <- as.factor(as.character(keyf$Partij))
levels(keyf$Partij2)
contrasts(keyf$Partij2) <- contr.sum(13) #let us use VVD as omitted party

summary(lm(outdegreesf~Partij2, keyf))
print("which parties deviate significantly outdegreesf")
levels(keyf$Partij2)[c(1, 6, 9, 10, 11)]

summary(lm(indegreesf~Partij2, keyf))
print("which parties deviate significantly indegreesf")
levels(keyf$Partij2)[c(10, 11)]

summary(lm(outdegreesatm~Partij2, keyf))
print("which parties deviate significantly outdegreesatm")
levels(keyf$Partij2)[c(4, 7, 10, 12)]

summary(lm(indegreesatm~Partij2, keyf))
print("which parties deviate significantly indegreesatm")
levels(keyf$Partij2)[c(4, 7, 10)]

summary(lm(outdegreesrt~Partij2, keyf))
print("which parties deviate significantly outdegreesrt")
levels(keyf$Partij2)[c(1, 4, 7, 10)]

summary(lm(indegreesrt~Partij2, keyf))
print("which parties deviate significantly indegreesrt")
levels(keyf$Partij2)[c(4, 10)]

```

---  

### Model 1 - final {.active}


```{r, echo=TRUE}
myeff <- getEffects( mydata )
myeff_m1 <- myeff

#according to suggestion of rsiena manual
myeff_m1 <- includeEffects( myeff_m1, inPopSqrt, name="fnet" )
myeff_m1 <- includeEffects( myeff_m1, inPopSqrt, name="atmnet" )
myeff_m1 <- includeEffects( myeff_m1, inPopSqrt, name="rtnet" )

myeff_m1 <- includeEffects( myeff_m1, outActSqrt, name="fnet" )
myeff_m1 <- includeEffects( myeff_m1, outActSqrt, name="atmnet" )
myeff_m1 <- includeEffects( myeff_m1, outActSqrt, name="rtnet" )

myeff_m1 <- includeEffects( myeff_m1, outPopSqrt, name="fnet" )
myeff_m1 <- includeEffects( myeff_m1, outPopSqrt, name="atmnet" )
myeff_m1 <- includeEffects( myeff_m1, outPopSqrt, name="rtnet" )

myeff_m1 <- includeEffects( myeff_m1, transTrip, name="fnet" )
myeff_m1 <- includeEffects( myeff_m1, transTrip, name="atmnet" )
myeff_m1 <- includeEffects( myeff_m1, transTrip, name="rtnet" )

myeff_m1 <- includeEffects( myeff_m1, sharedPop, name="fnet" )
myeff_m1 <- includeEffects( myeff_m1, sharedPop, name="atmnet" )
myeff_m1 <- includeEffects( myeff_m1, sharedPop, name="rtnet" )

myeff_m2 <- myeff_m1

#"kamerlid2016" "pleklijst"    "pleklijst1"

myeff_m2 <- includeEffects( myeff_m2, interaction1="kamerlid2016", altX, name="fnet" )
myeff_m2 <- includeEffects( myeff_m2, interaction1="kamerlid2016", altX, name="atmnet" )
myeff_m2 <- includeEffects( myeff_m2, interaction1="kamerlid2016", altX, name="rtnet" )

myeff_m2 <- includeEffects( myeff_m2, interaction1="kamerlid2016", egoX, name="fnet" )
myeff_m2 <- includeEffects( myeff_m2, interaction1="kamerlid2016", egoX, name="atmnet" )
myeff_m2 <- includeEffects( myeff_m2, interaction1="kamerlid2016", egoX, name="rtnet" )

myeff_m2 <- includeEffects( myeff_m2, interaction1="kamerlid2016", sameX, name="fnet" )
myeff_m2 <- includeEffects( myeff_m2, interaction1="kamerlid2016", sameX, name="atmnet" )
myeff_m2 <- includeEffects( myeff_m2, interaction1="kamerlid2016", sameX, name="rtnet" )

myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst1", altX, name="fnet" )
myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst1", altX, name="atmnet" )
myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst1", altX, name="rtnet" )

myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst1", egoX, name="fnet" )
myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst1", egoX, name="atmnet" )
myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst1", egoX, name="rtnet" )

myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst", egoX, name="fnet" )
myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst", egoX, name="atmnet" )
myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst", egoX, name="rtnet" )

myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst", altX, name="fnet" )
myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst", altX, name="atmnet" )
myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst", altX, name="rtnet" )

#these need to be dropped due to collinearity
#myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst", diffX, name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst", diffX, name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst", diffX, name="rtnet" )

#afstand
myeff_m2 <- includeEffects( myeff_m2, X, interaction1="afstand", name="fnet" )
myeff_m2 <- includeEffects( myeff_m2, X, interaction1="afstand", name="atmnet" )
myeff_m2 <- includeEffects( myeff_m2, X, interaction1="afstand", name="rtnet" )



#myeff_m2 <- includeEffects(myeff_m2, sameX, interaction1 = "partij", name="fnnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "cda", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "cu", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "denk", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "d66", name="fnet" )
myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "fvd", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "gl", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "pvda", name="fnet" )
myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "pvdd", name="fnet" )
myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "pvv", name="fnet" )
myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "sgp", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "sp", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "vvd", name="fnet" )
myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "plus", name="fnet" )

#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "cda", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "cu", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "denk", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "d66", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "fvd", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "gl", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "pvda", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "pvdd", name="fnet" )
myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "pvv", name="fnet" )
myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "sgp", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "sp", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "vvd", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "plus", name="fnet" )

myeff_m2 <- includeEffects(myeff_m2, sameX, interaction1 = "partij", name="atmnet" )

#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "cda", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "cu", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "denk", name="atmnet" )
myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "d66", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "fvd", name="atmnet" )
myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "gl", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "pvda", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "pvdd", name="atmnet" )
myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "pvv", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "sgp", name="atmnet" )
myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "sp", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "vvd", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "plus", name="atmnet" )

#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "cda", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "cu", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "denk", name="atmnet" )
myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "d66", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "fvd", name="atmnet" )
myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "gl", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "pvda", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "pvdd", name="atmnet" )
myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "pvv", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "sgp", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "sp", name="atmnet" )
# myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "vvd", name="atmnet" ) #referentie
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "plus", name="atmnet" )

myeff_m2 <- includeEffects(myeff_m2, sameX, interaction1 = "partij", name="rtnet" )

#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "cda", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "cu", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "denk", name="rtnet" )
myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "d66", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "fvd", name="rtnet" )
myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "gl", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "pvda", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "pvdd", name="rtnet" )
myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "pvv", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "sgp", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "sp", name="rtnet" )
# myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "vvd", name="rtnet" ) #referentie
myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "plus", name="rtnet" )

#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "cda", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "cu", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "denk", name="rtnet" )
myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "d66", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "fvd", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "gl", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "pvda", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "pvdd", name="rtnet" )
myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "pvv", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "sgp", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "sp", name="rtnet" )
# myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "vvd", name="rtnet" ) #referentie
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "plus", name="rtnet" )


load("ansM4b.RData")
myalgorithm <- sienaAlgorithmCreate( projname = 'M2')
ansM5 <- siena07( myalgorithm, data = mydata, prevAns=ansM4b, effects = myeff_m2, useCluster=TRUE, nbrNodes=8, initC=TRUE, batch=TRUE)
ansM5 
save(ansM5, file=paste("ansM5",".RData",sep=""))

ansM5b <- siena07( myalgorithm, data = mydata, prevAns=ansM5, effects = myeff_m2, useCluster=TRUE, nbrNodes=8, initC=TRUE, batch=TRUE)
ansM5b 
save(ansM5b, file=paste("ansM5b",".RData",sep=""))

# Lets trim


myeff <- getEffects( mydata )
myeff_m1 <- myeff

#according to suggestion of rsiena manual
myeff_m1 <- includeEffects( myeff_m1, inPopSqrt, name="fnet" )
myeff_m1 <- includeEffects( myeff_m1, inPopSqrt, name="atmnet" )
myeff_m1 <- includeEffects( myeff_m1, inPopSqrt, name="rtnet" )

myeff_m1 <- includeEffects( myeff_m1, outActSqrt, name="fnet" )
myeff_m1 <- includeEffects( myeff_m1, outActSqrt, name="atmnet" )
myeff_m1 <- includeEffects( myeff_m1, outActSqrt, name="rtnet" )

myeff_m1 <- includeEffects( myeff_m1, outPopSqrt, name="fnet" )
myeff_m1 <- includeEffects( myeff_m1, outPopSqrt, name="atmnet" )
myeff_m1 <- includeEffects( myeff_m1, outPopSqrt, name="rtnet" )

myeff_m1 <- includeEffects( myeff_m1, transTrip, name="fnet" )
myeff_m1 <- includeEffects( myeff_m1, transTrip, name="atmnet" )
myeff_m1 <- includeEffects( myeff_m1, transTrip, name="rtnet" )

myeff_m1 <- includeEffects( myeff_m1, sharedPop, name="fnet" )
myeff_m1 <- includeEffects( myeff_m1, sharedPop, name="atmnet" )
myeff_m1 <- includeEffects( myeff_m1, sharedPop, name="rtnet" )

myeff_m2 <- myeff_m1

#"kamerlid2016" "pleklijst"    "pleklijst1"

myeff_m2 <- includeEffects( myeff_m2, interaction1="kamerlid2016", altX, name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, interaction1="kamerlid2016", altX, name="atmnet" )
myeff_m2 <- includeEffects( myeff_m2, interaction1="kamerlid2016", altX, name="rtnet" )

myeff_m2 <- includeEffects( myeff_m2, interaction1="kamerlid2016", egoX, name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, interaction1="kamerlid2016", egoX, name="atmnet" )
myeff_m2 <- includeEffects( myeff_m2, interaction1="kamerlid2016", egoX, name="rtnet" )

myeff_m2 <- includeEffects( myeff_m2, interaction1="kamerlid2016", sameX, name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, interaction1="kamerlid2016", sameX, name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, interaction1="kamerlid2016", sameX, name="rtnet" )

#myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst1", altX, name="fnet" )
myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst1", altX, name="atmnet" )
myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst1", altX, name="rtnet" )

myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst1", egoX, name="fnet" )
myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst1", egoX, name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst1", egoX, name="rtnet" )

myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst", egoX, name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst", egoX, name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst", egoX, name="rtnet" )

myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst", altX, name="fnet" )
myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst", altX, name="atmnet" )
myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst", altX, name="rtnet" )

#these need to be dropped due to collinearity
#myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst", diffX, name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst", diffX, name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst", diffX, name="rtnet" )

#afstand
myeff_m2 <- includeEffects( myeff_m2, X, interaction1="afstand", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, X, interaction1="afstand", name="atmnet" )
myeff_m2 <- includeEffects( myeff_m2, X, interaction1="afstand", name="rtnet" )



myeff_m2 <- includeEffects(myeff_m2, sameX, interaction1 = "partij", name="fnet" )

#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "cda", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "cu", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "denk", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "d66", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "fvd", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "gl", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "pvda", name="fnet" )
myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "pvdd", name="fnet" )
myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "pvv", name="fnet" )
myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "sgp", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "sp", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "vvd", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "plus", name="fnet" )

#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "cda", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "cu", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "denk", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "d66", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "fvd", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "gl", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "pvda", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "pvdd", name="fnet" )
myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "pvv", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "sgp", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "sp", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "vvd", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "plus", name="fnet" )

myeff_m2 <- includeEffects(myeff_m2, sameX, interaction1 = "partij", name="atmnet" )

#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "cda", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "cu", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "denk", name="atmnet" )
myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "d66", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "fvd", name="atmnet" )
myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "gl", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "pvda", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "pvdd", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "pvv", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "sgp", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "sp", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "vvd", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "plus", name="atmnet" )

#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "cda", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "cu", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "denk", name="atmnet" )
myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "d66", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "fvd", name="atmnet" )
myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "gl", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "pvda", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "pvdd", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "pvv", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "sgp", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "sp", name="atmnet" )
# myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "vvd", name="atmnet" ) #referentie
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "plus", name="atmnet" )

myeff_m2 <- includeEffects(myeff_m2, sameX, interaction1 = "partij", name="rtnet" )

#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "cda", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "cu", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "denk", name="rtnet" )
myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "d66", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "fvd", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "gl", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "pvda", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "pvdd", name="rtnet" )
myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "pvv", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "sgp", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "sp", name="rtnet" )
# myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "vvd", name="rtnet" ) #referentie
myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "plus", name="rtnet" )

#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "cda", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "cu", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "denk", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "d66", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "fvd", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "gl", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "pvda", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "pvdd", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "pvv", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "sgp", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "sp", name="rtnet" )
# myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "vvd", name="rtnet" ) #referentie
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "plus", name="rtnet" )



load("ansM4b.RData") #start again from ansM4b
myalgorithm <- sienaAlgorithmCreate( projname = 'M3')
ansM6 <- siena07( myalgorithm, data = mydata, prevAns=ansM4b, effects = myeff_m2, useCluster=TRUE, nbrNodes=8, initC=TRUE, batch=TRUE)
ansM6 
save(ansM6, file=paste("ansM6",".RData",sep=""))

ansM6b <- siena07( myalgorithm, data = mydata, prevAns=ansM6, effects = myeff_m2, useCluster=TRUE, nbrNodes=8, initC=TRUE, batch=TRUE)
ansM6b 
save(ansM6b, file=paste("ansM6b",".RData",sep=""))

myeff <- getEffects( mydata )
myeff_m1 <- myeff

#according to suggestion of rsiena manual
myeff_m1 <- includeEffects( myeff_m1, inPopSqrt, name="fnet" )
myeff_m1 <- includeEffects( myeff_m1, inPopSqrt, name="atmnet" )
myeff_m1 <- includeEffects( myeff_m1, inPopSqrt, name="rtnet" )

myeff_m1 <- includeEffects( myeff_m1, outActSqrt, name="fnet" )
myeff_m1 <- includeEffects( myeff_m1, outActSqrt, name="atmnet" )
myeff_m1 <- includeEffects( myeff_m1, outActSqrt, name="rtnet" )

myeff_m1 <- includeEffects( myeff_m1, outPopSqrt, name="fnet" )
myeff_m1 <- includeEffects( myeff_m1, outPopSqrt, name="atmnet" )
myeff_m1 <- includeEffects( myeff_m1, outPopSqrt, name="rtnet" )

myeff_m1 <- includeEffects( myeff_m1, transTrip, name="fnet" )
myeff_m1 <- includeEffects( myeff_m1, transTrip, name="atmnet" )
myeff_m1 <- includeEffects( myeff_m1, transTrip, name="rtnet" )

myeff_m1 <- includeEffects( myeff_m1, sharedPop, name="fnet" )
myeff_m1 <- includeEffects( myeff_m1, sharedPop, name="atmnet" )
myeff_m1 <- includeEffects( myeff_m1, sharedPop, name="rtnet" )

myeff_m2 <- myeff_m1

#"kamerlid2016" "pleklijst"    "pleklijst1"

myeff_m2 <- includeEffects( myeff_m2, interaction1="kamerlid2016", altX, name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, interaction1="kamerlid2016", altX, name="atmnet" )
myeff_m2 <- includeEffects( myeff_m2, interaction1="kamerlid2016", altX, name="rtnet" )

myeff_m2 <- includeEffects( myeff_m2, interaction1="kamerlid2016", egoX, name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, interaction1="kamerlid2016", egoX, name="atmnet" )
myeff_m2 <- includeEffects( myeff_m2, interaction1="kamerlid2016", egoX, name="rtnet" )

myeff_m2 <- includeEffects( myeff_m2, interaction1="kamerlid2016", sameX, name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, interaction1="kamerlid2016", sameX, name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, interaction1="kamerlid2016", sameX, name="rtnet" )

#myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst1", altX, name="fnet" )
myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst1", altX, name="atmnet" )
myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst1", altX, name="rtnet" )

myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst1", egoX, name="fnet" )
myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst1", egoX, name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst1", egoX, name="rtnet" )

myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst", egoX, name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst", egoX, name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst", egoX, name="rtnet" )

#myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst", altX, name="fnet" )
myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst", altX, name="atmnet" )
myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst", altX, name="rtnet" )

#these need to be dropped due to collinearity
#myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst", diffX, name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst", diffX, name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst", diffX, name="rtnet" )

#afstand
myeff_m2 <- includeEffects( myeff_m2, X, interaction1="afstand", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, X, interaction1="afstand", name="atmnet" )
myeff_m2 <- includeEffects( myeff_m2, X, interaction1="afstand", name="rtnet" )



myeff_m2 <- includeEffects(myeff_m2, sameX, interaction1 = "partij", name="fnet" )

#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "cda", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "cu", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "denk", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "d66", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "fvd", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "gl", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "pvda", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "pvdd", name="fnet" )
myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "pvv", name="fnet" )
myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "sgp", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "sp", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "vvd", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "plus", name="fnet" )

#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "cda", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "cu", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "denk", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "d66", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "fvd", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "gl", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "pvda", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "pvdd", name="fnet" )
myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "pvv", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "sgp", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "sp", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "vvd", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "plus", name="fnet" )

myeff_m2 <- includeEffects(myeff_m2, sameX, interaction1 = "partij", name="atmnet" )

#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "cda", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "cu", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "denk", name="atmnet" )
myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "d66", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "fvd", name="atmnet" )
myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "gl", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "pvda", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "pvdd", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "pvv", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "sgp", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "sp", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "vvd", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "plus", name="atmnet" )

#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "cda", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "cu", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "denk", name="atmnet" )
myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "d66", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "fvd", name="atmnet" )
myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "gl", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "pvda", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "pvdd", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "pvv", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "sgp", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "sp", name="atmnet" )
# myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "vvd", name="atmnet" ) #referentie
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "plus", name="atmnet" )

myeff_m2 <- includeEffects(myeff_m2, sameX, interaction1 = "partij", name="rtnet" )

#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "cda", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "cu", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "denk", name="rtnet" )
myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "d66", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "fvd", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "gl", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "pvda", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "pvdd", name="rtnet" )
myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "pvv", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "sgp", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "sp", name="rtnet" )
# myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "vvd", name="rtnet" ) #referentie
myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "plus", name="rtnet" )

#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "cda", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "cu", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "denk", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "d66", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "fvd", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "gl", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "pvda", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "pvdd", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "pvv", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "sgp", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "sp", name="rtnet" )
# myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "vvd", name="rtnet" ) #referentie
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "plus", name="rtnet" )



load("ansM4b.RData") #start again from ansM4b
myalgorithm <- sienaAlgorithmCreate( projname = 'M4')
ansM7 <- siena07( myalgorithm, data = mydata, prevAns=ansM4b, effects = myeff_m2, useCluster=TRUE, nbrNodes=8, initC=TRUE, batch=TRUE)
ansM7 # Overall maximum convergence ratio:    0.2501 
save(ansM7, file=paste("ansM7",".RData",sep=""))

ansM7b <- siena07( myalgorithm, data = mydata, prevAns=ansM7, effects = myeff_m2, useCluster=TRUE, nbrNodes=8, initC=TRUE, batch=TRUE)
ansM7b # Overall maximum convergence ratio:    0.2422 
save(ansM7b, file=paste("ansM7b",".RData",sep=""))

load("ansM7b.RData")

ansM7c <- siena07( myalgorithm, data = mydata, prevAns=ansM7, effects = myeff_m2, useCluster=TRUE, nbrNodes=8, initC=TRUE, batch=TRUE)
ansM7c 
save(ansM7c, file=paste("ansM7c",".RData",sep=""))

#third trim

myeff <- getEffects( mydata )
myeff_m1 <- myeff

#according to suggestion of rsiena manual
myeff_m1 <- includeEffects( myeff_m1, inPopSqrt, name="fnet" )
myeff_m1 <- includeEffects( myeff_m1, inPopSqrt, name="atmnet" )
myeff_m1 <- includeEffects( myeff_m1, inPopSqrt, name="rtnet" )

myeff_m1 <- includeEffects( myeff_m1, outActSqrt, name="fnet" )
myeff_m1 <- includeEffects( myeff_m1, outActSqrt, name="atmnet" )
myeff_m1 <- includeEffects( myeff_m1, outActSqrt, name="rtnet" )

myeff_m1 <- includeEffects( myeff_m1, outPopSqrt, name="fnet" )
myeff_m1 <- includeEffects( myeff_m1, outPopSqrt, name="atmnet" )
myeff_m1 <- includeEffects( myeff_m1, outPopSqrt, name="rtnet" )

myeff_m1 <- includeEffects( myeff_m1, transTrip, name="fnet" )
myeff_m1 <- includeEffects( myeff_m1, transTrip, name="atmnet" )
myeff_m1 <- includeEffects( myeff_m1, transTrip, name="rtnet" )

myeff_m1 <- includeEffects( myeff_m1, sharedPop, name="fnet" )
myeff_m1 <- includeEffects( myeff_m1, sharedPop, name="atmnet" )
myeff_m1 <- includeEffects( myeff_m1, sharedPop, name="rtnet" )

myeff_m2 <- myeff_m1

#"kamerlid2016" "pleklijst"    "pleklijst1"

myeff_m2 <- includeEffects( myeff_m2, interaction1="kamerlid2016", altX, name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, interaction1="kamerlid2016", altX, name="atmnet" )
myeff_m2 <- includeEffects( myeff_m2, interaction1="kamerlid2016", altX, name="rtnet" )

#myeff_m2 <- includeEffects( myeff_m2, interaction1="kamerlid2016", egoX, name="fnet" )
#myeff_m2 <- setEffect( myeff_m2, interaction1="kamerlid2016", egoX, name="fnet", fix=TRUE, initialValue = -3, test=TRUE )

#myeff_m2 <- includeEffects( myeff_m2, interaction1="kamerlid2016", egoX, name="atmnet" )
myeff_m2 <- includeEffects( myeff_m2, interaction1="kamerlid2016", egoX, name="rtnet" )

myeff_m2 <- includeEffects( myeff_m2, interaction1="kamerlid2016", sameX, name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, interaction1="kamerlid2016", sameX, name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, interaction1="kamerlid2016", sameX, name="rtnet" )

#myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst1", altX, name="fnet" )
myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst1", altX, name="atmnet" )
myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst1", altX, name="rtnet" )

#myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst1", egoX, name="fnet" )
myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst1", egoX, name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst1", egoX, name="rtnet" )

myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst", egoX, name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst", egoX, name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst", egoX, name="rtnet" )

#myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst", altX, name="fnet" )
myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst", altX, name="atmnet" )
myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst", altX, name="rtnet" )

#these need to be dropped due to collinearity
#myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst", diffX, name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst", diffX, name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst", diffX, name="rtnet" )

#afstand
myeff_m2 <- includeEffects( myeff_m2, X, interaction1="afstand", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, X, interaction1="afstand", name="atmnet" )
myeff_m2 <- includeEffects( myeff_m2, X, interaction1="afstand", name="rtnet" )



myeff_m2 <- includeEffects(myeff_m2, sameX, interaction1 = "partij", name="fnet" )

#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "cda", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "cu", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "denk", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "d66", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "fvd", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "gl", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "pvda", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "pvdd", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "pvv", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "sgp", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "sp", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "vvd", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "plus", name="fnet" )

#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "cda", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "cu", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "denk", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "d66", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "fvd", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "gl", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "pvda", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "pvdd", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "pvv", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "sgp", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "sp", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "vvd", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "plus", name="fnet" )

myeff_m2 <- includeEffects(myeff_m2, sameX, interaction1 = "partij", name="atmnet" )

#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "cda", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "cu", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "denk", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "d66", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "fvd", name="atmnet" )
myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "gl", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "pvda", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "pvdd", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "pvv", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "sgp", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "sp", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "vvd", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "plus", name="atmnet" )

#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "cda", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "cu", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "denk", name="atmnet" )
myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "d66", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "fvd", name="atmnet" )
myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "gl", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "pvda", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "pvdd", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "pvv", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "sgp", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "sp", name="atmnet" )
# myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "vvd", name="atmnet" ) #referentie
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "plus", name="atmnet" )

myeff_m2 <- includeEffects(myeff_m2, sameX, interaction1 = "partij", name="rtnet" )

#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "cda", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "cu", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "denk", name="rtnet" )
myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "d66", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "fvd", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "gl", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "pvda", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "pvdd", name="rtnet" )
myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "pvv", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "sgp", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "sp", name="rtnet" )
# myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "vvd", name="rtnet" ) #referentie
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "plus", name="rtnet" )

#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "cda", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "cu", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "denk", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "d66", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "fvd", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "gl", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "pvda", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "pvdd", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "pvv", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "sgp", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "sp", name="rtnet" )
# myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "vvd", name="rtnet" ) #referentie
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "plus", name="rtnet" )


# Estimates

load("ansM8c.RData") #start again from ansM4b
ansM4b
myalgorithm <- sienaAlgorithmCreate( projname = 'M5')
ansM8 <- siena07( myalgorithm, data = mydata, prevAns=ansM4b, effects = myeff_m2, useCluster=TRUE, nbrNodes=8, initC=TRUE, batch=TRUE)
ansM8 
save(ansM8, file=paste("ansM8",".RData",sep=""))

ansM8b <- siena07( myalgorithm, data = mydata, prevAns=ansM8, effects = myeff_m2, useCluster=TRUE, nbrNodes=8, initC=TRUE, batch=TRUE)
ansM8b 
save(ansM8b, file=paste("ansM8b",".RData",sep=""))

ansM8c <- siena07( myalgorithm, data = mydata, prevAns=ansM8b, effects = myeff_m2, useCluster=TRUE, nbrNodes=8, initC=TRUE, batch=TRUE)
ansM8c #Overall maximum convergence ratio:    0.2471 

save(ansM8c, file=paste("ansM8c",".RData",sep=""))
```

```{r, eval=TRUE}
load("ansM8c.RData")
#ansM8c

#xtable.sienaFit(ansM8c, file="ansM8c.html", type="html", digits=3)

res <- round(fanscsv(ansM8c)[-48,1:2],5)
mc <- as.character(round(fanscsv(ansM8c)[48,1],3))
row.names(res) <- c(
 "rate 1"  ,      
 "rate 2"   ,     
 "outdegree"          ,  
 "reciprocity"         ,           
 "transitive triplets"  ,          
 "shared popularity"     ,         
 "indegree - popularity"   ,
  " outdegree - popularity" , 
 "outdegree - activity"    ,
 "seating distance (dyad)"         ,               
 "same party (dyad)"                ,    
"incumbancy status (alter)"          ,   
"same incumbancy status (dyad)"       ,       
"position on election list (ego)"      ,            
 "rate 1"      ,
 "rate 2"      ,
"outdegree"          ,
 "reciprocity"        ,          
 "transitive triplets" ,         
 "shared popularity"    ,        
 "indegree - popularity" ,
 "outdegree - popularity",
"outdegree - activity "  ,
 "same party (dyad)"            ,      
"party Liberal Democrats (alter)",                    
"party GreenLeft (alter)"         ,            
 "party GreenLeft (ego)"           ,            
 "position on election list (alter)",              
"party leader (alter)"             ,
 "party leader (ego)"               ,
 "rate 1"       ,
 "rate 2"       ,
"outdegree"           ,
"reciprocity"          ,         
"transitive triplets"   ,        
"shared popularity"      ,       
"indegree - popularity ",  
"outdegree - popularity", 
"outdegree - activity "   ,
"seating distance (dyad)"        ,               
 "same party (dyad)"              ,     
 "party Liberal Democrats (ego)"   ,                    
 "party Freedom Party (ego)"        ,               
 "incumbancy status (alter)"         ,   
 "incumbancy status (ego)"            ,  
 "position on election list (alter)"   ,            
"party leader (alter)"
)
  
asmatkable <- kbl(res, booktabs=TRUE, digits=3, caption="Model 1", align = "c") %>%
  kable_classic(full_width = F, html_font = "Cambria") %>%
  kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive")) %>%
  column_spec(column = 1, width = "3in")   %>%
  row_spec(c(11, 24,41), bold = T, color = "white", background = "#D7261E") %>%
  group_rows(index = c("Following" = 14, "Atmention" = 15, "Retweets" = 18)) %>%
  footnote(general = paste("Overall maximum convergence ratio: ", mc, sep="" ))


asmatkable




```

---  


## Model 2  {.active}

To what extent do we observe social inbreeding homophily and to what extent does this explain the impact of the same-party variable (Hypotheses 2a and 2b) 

```{r, echo=TRUE}
myeff <- getEffects( mydata )
myeff_m1 <- myeff

#according to suggestion of rsiena manual
myeff_m1 <- includeEffects( myeff_m1, inPopSqrt, name="fnet" )
myeff_m1 <- includeEffects( myeff_m1, inPopSqrt, name="atmnet" )
myeff_m1 <- includeEffects( myeff_m1, inPopSqrt, name="rtnet" )

myeff_m1 <- includeEffects( myeff_m1, outActSqrt, name="fnet" )
myeff_m1 <- includeEffects( myeff_m1, outActSqrt, name="atmnet" )
myeff_m1 <- includeEffects( myeff_m1, outActSqrt, name="rtnet" )

myeff_m1 <- includeEffects( myeff_m1, outPopSqrt, name="fnet" )
myeff_m1 <- includeEffects( myeff_m1, outPopSqrt, name="atmnet" )
myeff_m1 <- includeEffects( myeff_m1, outPopSqrt, name="rtnet" )

myeff_m1 <- includeEffects( myeff_m1, transTrip, name="fnet" )
myeff_m1 <- includeEffects( myeff_m1, transTrip, name="atmnet" )
myeff_m1 <- includeEffects( myeff_m1, transTrip, name="rtnet" )

myeff_m1 <- includeEffects( myeff_m1, sharedPop, name="fnet" )
myeff_m1 <- includeEffects( myeff_m1, sharedPop, name="atmnet" )
myeff_m1 <- includeEffects( myeff_m1, sharedPop, name="rtnet" )

myeff_m2 <- myeff_m1

#"kamerlid2016" "pleklijst"    "pleklijst1"

myeff_m2 <- includeEffects( myeff_m2, interaction1="kamerlid2016", altX, name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, interaction1="kamerlid2016", altX, name="atmnet" )
myeff_m2 <- includeEffects( myeff_m2, interaction1="kamerlid2016", altX, name="rtnet" )

#myeff_m2 <- includeEffects( myeff_m2, interaction1="kamerlid2016", egoX, name="fnet" )
#myeff_m2 <- setEffect( myeff_m2, interaction1="kamerlid2016", egoX, name="fnet", fix=TRUE, initialValue = -3, test=TRUE )

#myeff_m2 <- includeEffects( myeff_m2, interaction1="kamerlid2016", egoX, name="atmnet" )
myeff_m2 <- includeEffects( myeff_m2, interaction1="kamerlid2016", egoX, name="rtnet" )

myeff_m2 <- includeEffects( myeff_m2, interaction1="kamerlid2016", sameX, name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, interaction1="kamerlid2016", sameX, name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, interaction1="kamerlid2016", sameX, name="rtnet" )

#myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst1", altX, name="fnet" )
myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst1", altX, name="atmnet" )
myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst1", altX, name="rtnet" )

#myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst1", egoX, name="fnet" )
myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst1", egoX, name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst1", egoX, name="rtnet" )

myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst", egoX, name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst", egoX, name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst", egoX, name="rtnet" )

#myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst", altX, name="fnet" )
myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst", altX, name="atmnet" )
myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst", altX, name="rtnet" )

#these need to be dropped due to collinearity
#myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst", diffX, name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst", diffX, name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst", diffX, name="rtnet" )

#afstand
myeff_m2 <- includeEffects( myeff_m2, X, interaction1="afstand", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, X, interaction1="afstand", name="atmnet" )
myeff_m2 <- includeEffects( myeff_m2, X, interaction1="afstand", name="rtnet" )



myeff_m2 <- includeEffects(myeff_m2, sameX, interaction1 = "partij", name="fnet" )

#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "cda", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "cu", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "denk", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "d66", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "fvd", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "gl", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "pvda", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "pvdd", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "pvv", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "sgp", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "sp", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "vvd", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "plus", name="fnet" )

#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "cda", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "cu", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "denk", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "d66", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "fvd", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "gl", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "pvda", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "pvdd", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "pvv", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "sgp", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "sp", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "vvd", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "plus", name="fnet" )

myeff_m2 <- includeEffects(myeff_m2, sameX, interaction1 = "partij", name="atmnet" )

#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "cda", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "cu", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "denk", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "d66", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "fvd", name="atmnet" )
myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "gl", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "pvda", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "pvdd", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "pvv", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "sgp", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "sp", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "vvd", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "plus", name="atmnet" )

#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "cda", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "cu", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "denk", name="atmnet" )
myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "d66", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "fvd", name="atmnet" )
myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "gl", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "pvda", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "pvdd", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "pvv", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "sgp", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "sp", name="atmnet" )
# myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "vvd", name="atmnet" ) #referentie
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "plus", name="atmnet" )

myeff_m2 <- includeEffects(myeff_m2, sameX, interaction1 = "partij", name="rtnet" )

#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "cda", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "cu", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "denk", name="rtnet" )
myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "d66", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "fvd", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "gl", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "pvda", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "pvdd", name="rtnet" )
myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "pvv", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "sgp", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "sp", name="rtnet" )
# myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "vvd", name="rtnet" ) #referentie
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "plus", name="rtnet" )

#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "cda", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "cu", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "denk", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "d66", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "fvd", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "gl", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "pvda", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "pvdd", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "pvv", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "sgp", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "sp", name="rtnet" )
# myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "vvd", name="rtnet" ) #referentie
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "plus", name="rtnet" )

myeff_m3 <- myeff_m2

myeff_m3 <- includeEffects(myeff_m3, sameX, interaction1 = "vrouw", name="fnet" )
myeff_m3 <- includeEffects(myeff_m3, egoX, interaction1 = "vrouw", name="fnet" )
myeff_m3 <- includeEffects(myeff_m3, altX, interaction1 = "vrouw", name="fnet" )

myeff_m3 <- includeEffects(myeff_m3, sameX, interaction1 = "vrouw", name="rtnet" )
myeff_m3 <- includeEffects(myeff_m3, egoX, interaction1 = "vrouw", name="rtnet" )
myeff_m3 <- includeEffects(myeff_m3, altX, interaction1 = "vrouw", name="rtnet" )

myeff_m3 <- includeEffects(myeff_m3, sameX, interaction1 = "vrouw", name="atmnet" )
myeff_m3 <- includeEffects(myeff_m3, egoX, interaction1 = "vrouw", name="atmnet" )
myeff_m3 <- includeEffects(myeff_m3, altX, interaction1 = "vrouw", name="atmnet" )

myeff_m3 <- includeEffects(myeff_m3, absDiffX , interaction1 = "lft", name="fnet" )
myeff_m3 <- includeEffects(myeff_m3, egoX, interaction1 = "lft", name="fnet" )
myeff_m3 <- includeEffects(myeff_m3, altX, interaction1 = "lft", name="fnet" )

myeff_m3 <- includeEffects(myeff_m3, absDiffX , interaction1 = "lft", name="rtnet" )
myeff_m3 <- includeEffects(myeff_m3, egoX, interaction1 = "lft", name="rtnet" )
myeff_m3 <- includeEffects(myeff_m3, altX, interaction1 = "lft", name="rtnet" )

myeff_m3 <- includeEffects(myeff_m3, absDiffX , interaction1 = "lft", name="atmnet" )
myeff_m3 <- includeEffects(myeff_m3, egoX, interaction1 = "lft", name="atmnet" )
myeff_m3 <- includeEffects(myeff_m3, altX, interaction1 = "lft", name="atmnet" )

myeff_m3 <- includeEffects(myeff_m3, sameX, interaction1 = "ethminz", name="fnet" )
myeff_m3 <- includeEffects(myeff_m3, egoX, interaction1 = "ethminz", name="fnet" )
myeff_m3 <- includeEffects(myeff_m3, altX, interaction1 = "ethminz", name="fnet" )

myeff_m3 <- includeEffects(myeff_m3, sameX, interaction1 = "ethminz", name="rtnet" )
myeff_m3 <- includeEffects(myeff_m3, egoX, interaction1 = "ethminz", name="rtnet" )
myeff_m3 <- includeEffects(myeff_m3, altX, interaction1 = "ethminz", name="rtnet" )

myeff_m3 <- includeEffects(myeff_m3, sameX, interaction1 = "ethminz", name="atmnet" )
myeff_m3 <- includeEffects(myeff_m3, egoX, interaction1 = "ethminz", name="atmnet" )
myeff_m3 <- includeEffects(myeff_m3, altX, interaction1 = "ethminz", name="atmnet" )



# Estimates

load("ansM8c.RData") 

myalgorithm <- sienaAlgorithmCreate( projname = 'M9')
ansM9 <- siena07( myalgorithm, data = mydata, prevAns=ansM8c, effects = myeff_m3, useCluster=TRUE, nbrNodes=8, initC=TRUE, batch=TRUE)
ansM9 
save(ansM9, file=paste("ansM9",".RData",sep=""))

ansM9b <- siena07( myalgorithm, data = mydata, prevAns=ansM9, effects = myeff_m3, useCluster=TRUE, nbrNodes=8, initC=TRUE, batch=TRUE)
ansM9b 
save(ansM9b, file=paste("ansM9b",".RData",sep=""))

ansM9c <- siena07( myalgorithm, data = mydata, prevAns=ansM9b, effects = myeff_m3, useCluster=TRUE, nbrNodes=8, initC=TRUE, batch=TRUE)
ansM9c 

save(ansM9c, file=paste("ansM9c",".RData",sep=""))

# Trim social inbreeding homophily 

# Only ego alter. we leave dyad in. 
# Note, we now also exclude rtnet:kamerlid2016 alter
# 
# Effects 

myeff <- getEffects( mydata )
myeff_m1 <- myeff

#according to suggestion of rsiena manual
myeff_m1 <- includeEffects( myeff_m1, inPopSqrt, name="fnet" )
myeff_m1 <- includeEffects( myeff_m1, inPopSqrt, name="atmnet" )
myeff_m1 <- includeEffects( myeff_m1, inPopSqrt, name="rtnet" )

myeff_m1 <- includeEffects( myeff_m1, outActSqrt, name="fnet" )
myeff_m1 <- includeEffects( myeff_m1, outActSqrt, name="atmnet" )
myeff_m1 <- includeEffects( myeff_m1, outActSqrt, name="rtnet" )

myeff_m1 <- includeEffects( myeff_m1, outPopSqrt, name="fnet" )
myeff_m1 <- includeEffects( myeff_m1, outPopSqrt, name="atmnet" )
myeff_m1 <- includeEffects( myeff_m1, outPopSqrt, name="rtnet" )

myeff_m1 <- includeEffects( myeff_m1, transTrip, name="fnet" )
myeff_m1 <- includeEffects( myeff_m1, transTrip, name="atmnet" )
myeff_m1 <- includeEffects( myeff_m1, transTrip, name="rtnet" )

myeff_m1 <- includeEffects( myeff_m1, sharedPop, name="fnet" )
myeff_m1 <- includeEffects( myeff_m1, sharedPop, name="atmnet" )
myeff_m1 <- includeEffects( myeff_m1, sharedPop, name="rtnet" )

myeff_m2 <- myeff_m1

#"kamerlid2016" "pleklijst"    "pleklijst1"

myeff_m2 <- includeEffects( myeff_m2, interaction1="kamerlid2016", altX, name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, interaction1="kamerlid2016", altX, name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, interaction1="kamerlid2016", altX, name="rtnet" )

#myeff_m2 <- includeEffects( myeff_m2, interaction1="kamerlid2016", egoX, name="fnet" )
#myeff_m2 <- setEffect( myeff_m2, interaction1="kamerlid2016", egoX, name="fnet", fix=TRUE, initialValue = -3, test=TRUE )

#myeff_m2 <- includeEffects( myeff_m2, interaction1="kamerlid2016", egoX, name="atmnet" )
myeff_m2 <- includeEffects( myeff_m2, interaction1="kamerlid2016", egoX, name="rtnet" )

myeff_m2 <- includeEffects( myeff_m2, interaction1="kamerlid2016", sameX, name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, interaction1="kamerlid2016", sameX, name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, interaction1="kamerlid2016", sameX, name="rtnet" )

#myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst1", altX, name="fnet" )
myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst1", altX, name="atmnet" )
myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst1", altX, name="rtnet" )

#myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst1", egoX, name="fnet" )
myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst1", egoX, name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst1", egoX, name="rtnet" )

myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst", egoX, name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst", egoX, name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst", egoX, name="rtnet" )

#myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst", altX, name="fnet" )
myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst", altX, name="atmnet" )
myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst", altX, name="rtnet" )

#these need to be dropped due to collinearity
#myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst", diffX, name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst", diffX, name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst", diffX, name="rtnet" )

#afstand
myeff_m2 <- includeEffects( myeff_m2, X, interaction1="afstand", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, X, interaction1="afstand", name="atmnet" )
myeff_m2 <- includeEffects( myeff_m2, X, interaction1="afstand", name="rtnet" )



myeff_m2 <- includeEffects(myeff_m2, sameX, interaction1 = "partij", name="fnet" )

#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "cda", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "cu", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "denk", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "d66", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "fvd", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "gl", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "pvda", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "pvdd", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "pvv", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "sgp", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "sp", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "vvd", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "plus", name="fnet" )

#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "cda", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "cu", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "denk", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "d66", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "fvd", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "gl", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "pvda", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "pvdd", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "pvv", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "sgp", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "sp", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "vvd", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "plus", name="fnet" )

myeff_m2 <- includeEffects(myeff_m2, sameX, interaction1 = "partij", name="atmnet" )

#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "cda", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "cu", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "denk", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "d66", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "fvd", name="atmnet" )
myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "gl", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "pvda", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "pvdd", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "pvv", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "sgp", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "sp", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "vvd", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "plus", name="atmnet" )

#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "cda", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "cu", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "denk", name="atmnet" )
myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "d66", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "fvd", name="atmnet" )
myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "gl", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "pvda", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "pvdd", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "pvv", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "sgp", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "sp", name="atmnet" )
# myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "vvd", name="atmnet" ) #referentie
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "plus", name="atmnet" )

myeff_m2 <- includeEffects(myeff_m2, sameX, interaction1 = "partij", name="rtnet" )

#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "cda", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "cu", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "denk", name="rtnet" )
myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "d66", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "fvd", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "gl", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "pvda", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "pvdd", name="rtnet" )
myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "pvv", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "sgp", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "sp", name="rtnet" )
# myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "vvd", name="rtnet" ) #referentie
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "plus", name="rtnet" )

#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "cda", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "cu", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "denk", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "d66", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "fvd", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "gl", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "pvda", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "pvdd", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "pvv", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "sgp", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "sp", name="rtnet" )
# myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "vvd", name="rtnet" ) #referentie
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "plus", name="rtnet" )

myeff_m3 <- myeff_m2

myeff_m3 <- includeEffects(myeff_m3, sameX, interaction1 = "vrouw", name="fnet" )
#myeff_m3 <- includeEffects(myeff_m3, egoX, interaction1 = "vrouw", name="fnet" )
myeff_m3 <- includeEffects(myeff_m3, altX, interaction1 = "vrouw", name="fnet" )

myeff_m3 <- includeEffects(myeff_m3, sameX, interaction1 = "vrouw", name="rtnet" )
myeff_m3 <- includeEffects(myeff_m3, egoX, interaction1 = "vrouw", name="rtnet" )
myeff_m3 <- includeEffects(myeff_m3, altX, interaction1 = "vrouw", name="rtnet" )

myeff_m3 <- includeEffects(myeff_m3, sameX, interaction1 = "vrouw", name="atmnet" )
#myeff_m3 <- includeEffects(myeff_m3, egoX, interaction1 = "vrouw", name="atmnet" )
#myeff_m3 <- includeEffects(myeff_m3, altX, interaction1 = "vrouw", name="atmnet" )

myeff_m3 <- includeEffects(myeff_m3, absDiffX , interaction1 = "lft", name="fnet" )
myeff_m3 <- includeEffects(myeff_m3, egoX, interaction1 = "lft", name="fnet" )
myeff_m3 <- includeEffects(myeff_m3, altX, interaction1 = "lft", name="fnet" )

myeff_m3 <- includeEffects(myeff_m3, absDiffX , interaction1 = "lft", name="rtnet" )
#myeff_m3 <- includeEffects(myeff_m3, egoX, interaction1 = "lft", name="rtnet" )
myeff_m3 <- includeEffects(myeff_m3, altX, interaction1 = "lft", name="rtnet" )

myeff_m3 <- includeEffects(myeff_m3, absDiffX , interaction1 = "lft", name="atmnet" )
#myeff_m3 <- includeEffects(myeff_m3, egoX, interaction1 = "lft", name="atmnet" )
#myeff_m3 <- includeEffects(myeff_m3, altX, interaction1 = "lft", name="atmnet" )

myeff_m3 <- includeEffects(myeff_m3, sameX, interaction1 = "ethminz", name="fnet" )
#myeff_m3 <- includeEffects(myeff_m3, egoX, interaction1 = "ethminz", name="fnet" )
#myeff_m3 <- includeEffects(myeff_m3, altX, interaction1 = "ethminz", name="fnet" )

myeff_m3 <- includeEffects(myeff_m3, sameX, interaction1 = "ethminz", name="rtnet" )
myeff_m3 <- includeEffects(myeff_m3, egoX, interaction1 = "ethminz", name="rtnet" )
#myeff_m3 <- includeEffects(myeff_m3, altX, interaction1 = "ethminz", name="rtnet" )

myeff_m3 <- includeEffects(myeff_m3, sameX, interaction1 = "ethminz", name="atmnet" )
#myeff_m3 <- includeEffects(myeff_m3, egoX, interaction1 = "ethminz", name="atmnet" )
#myeff_m3 <- includeEffects(myeff_m3, altX, interaction1 = "ethminz", name="atmnet" )


# Estimates

load("ansM8c.RData") 

myalgorithm <- sienaAlgorithmCreate( projname = 'M10')
ansM10 <- siena07( myalgorithm, data = mydata, prevAns=ansM8c, effects = myeff_m3, useCluster=TRUE, nbrNodes=8, initC=TRUE, batch=TRUE)
ansM10 
save(ansM10, file=paste("ansM10",".RData",sep=""))

ansM10b <- siena07( myalgorithm, data = mydata, prevAns=ansM10, effects = myeff_m3, useCluster=TRUE, nbrNodes=8, initC=TRUE, batch=TRUE)
ansM10b 
save(ansM10b, file=paste("ansM10b",".RData",sep=""))

#switching to different computer

load("ansM10c.RData") 
ansM10b
ansM10c <- siena07( myalgorithm, data = mydata, prevAns=ansM10b, effects = myeff_m3, useCluster=TRUE, nbrNodes=12, initC=TRUE, batch=TRUE)
ansM10c # Overall maximum convergence ratio:    0.2528 

save(ansM10c, file=paste("ansM10c",".RData",sep=""))

ansM10d <- siena07( myalgorithm, data = mydata, prevAns=ansM10c, effects = myeff_m3, useCluster=TRUE, nbrNodes=10, initC=TRUE, batch=TRUE)
ansM10d 

save(ansM10d, file=paste("ansM10d",".RData",sep=""))

```

```{r, echo=FALSE}
myalgorithm <- sienaAlgorithmCreate( projname = 'RR2', n3 = 3000)
ansRR2 <- siena07( myalgorithm, data = mydata, prevAns=ansM10c, effects = myeff_m3, useCluster=TRUE, nbrNodes=10, initC=TRUE, batch=TRUE)
ansRR2
#save(ansRR2, file=paste("ansRR2",".RData",sep=""))
```


```{r, eval=TRUE}
load("ansRR2.RData")
#ansRR2

res <- round(fanscsv(ansRR2)[-63,1:2],5)
mc <- as.character(round(fanscsv(ansRR2)[63,1],3))
row.names(res) <- c(
 "rate 1"  ,      
 "rate 2"   ,     
 "outdegree"          ,  
 "reciprocity"         ,           
 "transitive triplets"  ,          
 "shared popularity"     ,         
 "indegree - popularity (sqrt)"   ,
  "outdegree - popularity (sqrt)" , 
 "outdegree - activity (sqrt)"    ,
 "seating distance (dyad)"         ,               
 "same party (dyad)"                ,
 "same ethnic minority status (dyad)" , 
 "woman (alter)", 
 "same sex (dyad)",
 "age (alter)", 
 "age (ego)",
 "absolute difference age (dyad)",
"incumbancy status (alter)"          ,   
"same incumbancy status (dyad)"       ,       
"position on election list (ego)"      ,            
 "rate 1"      ,
 "rate 2"      ,
"outdegree"          ,
 "reciprocity"        ,          
 "transitive triplets" ,         
 "shared popularity"    ,        
 "indegree - popularity (sqrt)" ,
 "outdegree - popularity (sqrt)",
"outdegree - activity (sqrt)"  ,
 "same party (dyad)"            ,      
"party Liberal Democrats (alter)",                    
"party GreenLeft (alter)"         ,            
 "party GreenLeft (ego)"           ,
"same ethnic minority status (dyad)",
"same sex (dyad)",
"absolute difference age (dyad)",
 "position on election list (alter)",              
"party leader (alter)"             ,
 "party leader (ego)"               ,
 "rate 1"       ,
 "rate 2"       ,
"outdegree"           ,
"reciprocity"          ,         
"transitive triplets"   ,        
"shared popularity"      ,       
"indegree - popularity (sqrt)",  
"outdegree - popularity (sqrt)", 
"outdegree - activity (sqrt)"   ,
"seating distance (dyad)"        ,               
 "same party (dyad)"              ,     
 "party Liberal Democrats (ego)"   ,                    
 "party Freedom Party (ego)"        ,
"ethnic minority status (ego)", 
"same ethnic minority status (dyad)", 
"woman (alter)",
"women (ego)", 
"same sex (dyad)", 
"age (alter)",
"absolute difference age (dyad)",
 "incumbancy status (ego)"            ,  
 "position on election list (alter)"   ,            
"party leader (alter)"
)
  
SME <- kbl(res, booktabs=TRUE, digits=3, caption="SM E: Model 2", align = "c") %>%
  kable_classic(full_width = F, html_font = "Cambria") %>%
  kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive")) %>%
  column_spec(column = 1, width = "3in")   %>%
  row_spec(c(11, 30,50), bold = T, color = "white", background = "#D7261E") %>%
  group_rows(index = c("Following" = 20, "Atmention" = 19, "Retweets" = 23)) %>%
  footnote(general = paste("Overall maximum convergence ratio: ", mc, sep="" ))


SME

```
  
  
---  



## Model 3  

Cross-network effects. Hypotheses 4. 

Remove the non-significant social inbreeding parameters (t-value < 1): 


```{r, echo=TRUE}


myeff <- getEffects( mydata )
myeff_m1 <- myeff

#according to suggestion of rsiena manual
myeff_m1 <- includeEffects( myeff_m1, inPopSqrt, name="fnet" )
myeff_m1 <- includeEffects( myeff_m1, inPopSqrt, name="atmnet" )
myeff_m1 <- includeEffects( myeff_m1, inPopSqrt, name="rtnet" )

myeff_m1 <- includeEffects( myeff_m1, outActSqrt, name="fnet" )
myeff_m1 <- includeEffects( myeff_m1, outActSqrt, name="atmnet" )
myeff_m1 <- includeEffects( myeff_m1, outActSqrt, name="rtnet" )

myeff_m1 <- includeEffects( myeff_m1, outPopSqrt, name="fnet" )
myeff_m1 <- includeEffects( myeff_m1, outPopSqrt, name="atmnet" )
myeff_m1 <- includeEffects( myeff_m1, outPopSqrt, name="rtnet" )

myeff_m1 <- includeEffects( myeff_m1, transTrip, name="fnet" )
myeff_m1 <- includeEffects( myeff_m1, transTrip, name="atmnet" )
myeff_m1 <- includeEffects( myeff_m1, transTrip, name="rtnet" )

myeff_m1 <- includeEffects( myeff_m1, sharedPop, name="fnet" )
myeff_m1 <- includeEffects( myeff_m1, sharedPop, name="atmnet" )
myeff_m1 <- includeEffects( myeff_m1, sharedPop, name="rtnet" )

myeff_m2 <- myeff_m1

#"kamerlid2016" "pleklijst"    "pleklijst1"

myeff_m2 <- includeEffects( myeff_m2, interaction1="kamerlid2016", altX, name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, interaction1="kamerlid2016", altX, name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, interaction1="kamerlid2016", altX, name="rtnet" )

#myeff_m2 <- includeEffects( myeff_m2, interaction1="kamerlid2016", egoX, name="fnet" )
#myeff_m2 <- setEffect( myeff_m2, interaction1="kamerlid2016", egoX, name="fnet", fix=TRUE, initialValue = -3, test=TRUE )

#myeff_m2 <- includeEffects( myeff_m2, interaction1="kamerlid2016", egoX, name="atmnet" )
myeff_m2 <- includeEffects( myeff_m2, interaction1="kamerlid2016", egoX, name="rtnet" )

myeff_m2 <- includeEffects( myeff_m2, interaction1="kamerlid2016", sameX, name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, interaction1="kamerlid2016", sameX, name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, interaction1="kamerlid2016", sameX, name="rtnet" )

#myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst1", altX, name="fnet" )
myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst1", altX, name="atmnet" )
myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst1", altX, name="rtnet" )

#myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst1", egoX, name="fnet" )
myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst1", egoX, name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst1", egoX, name="rtnet" )

myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst", egoX, name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst", egoX, name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst", egoX, name="rtnet" )

#myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst", altX, name="fnet" )
myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst", altX, name="atmnet" )
myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst", altX, name="rtnet" )

#these need to be dropped due to collinearity
#myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst", diffX, name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst", diffX, name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst", diffX, name="rtnet" )

#afstand
myeff_m2 <- includeEffects( myeff_m2, X, interaction1="afstand", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, X, interaction1="afstand", name="atmnet" )
myeff_m2 <- includeEffects( myeff_m2, X, interaction1="afstand", name="rtnet" )



myeff_m2 <- includeEffects(myeff_m2, sameX, interaction1 = "partij", name="fnet" )

#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "cda", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "cu", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "denk", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "d66", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "fvd", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "gl", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "pvda", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "pvdd", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "pvv", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "sgp", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "sp", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "vvd", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "plus", name="fnet" )

#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "cda", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "cu", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "denk", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "d66", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "fvd", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "gl", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "pvda", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "pvdd", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "pvv", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "sgp", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "sp", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "vvd", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "plus", name="fnet" )

myeff_m2 <- includeEffects(myeff_m2, sameX, interaction1 = "partij", name="atmnet" )

#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "cda", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "cu", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "denk", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "d66", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "fvd", name="atmnet" )
myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "gl", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "pvda", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "pvdd", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "pvv", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "sgp", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "sp", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "vvd", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "plus", name="atmnet" )

#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "cda", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "cu", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "denk", name="atmnet" )
myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "d66", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "fvd", name="atmnet" )
myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "gl", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "pvda", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "pvdd", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "pvv", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "sgp", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "sp", name="atmnet" )
# myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "vvd", name="atmnet" ) #referentie
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "plus", name="atmnet" )

myeff_m2 <- includeEffects(myeff_m2, sameX, interaction1 = "partij", name="rtnet" )

#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "cda", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "cu", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "denk", name="rtnet" )
myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "d66", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "fvd", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "gl", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "pvda", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "pvdd", name="rtnet" )
myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "pvv", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "sgp", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "sp", name="rtnet" )
# myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "vvd", name="rtnet" ) #referentie
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "plus", name="rtnet" )

#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "cda", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "cu", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "denk", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "d66", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "fvd", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "gl", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "pvda", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "pvdd", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "pvv", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "sgp", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "sp", name="rtnet" )
# myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "vvd", name="rtnet" ) #referentie
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "plus", name="rtnet" )

myeff_m3 <- myeff_m2

myeff_m3 <- includeEffects(myeff_m3, sameX, interaction1 = "vrouw", name="fnet" )
#myeff_m3 <- includeEffects(myeff_m3, egoX, interaction1 = "vrouw", name="fnet" )
myeff_m3 <- includeEffects(myeff_m3, altX, interaction1 = "vrouw", name="fnet" )

myeff_m3 <- includeEffects(myeff_m3, sameX, interaction1 = "vrouw", name="rtnet" )
myeff_m3 <- includeEffects(myeff_m3, egoX, interaction1 = "vrouw", name="rtnet" )
myeff_m3 <- includeEffects(myeff_m3, altX, interaction1 = "vrouw", name="rtnet" )

myeff_m3 <- includeEffects(myeff_m3, sameX, interaction1 = "vrouw", name="atmnet" )
#myeff_m3 <- includeEffects(myeff_m3, egoX, interaction1 = "vrouw", name="atmnet" )
#myeff_m3 <- includeEffects(myeff_m3, altX, interaction1 = "vrouw", name="atmnet" )

myeff_m3 <- includeEffects(myeff_m3, absDiffX , interaction1 = "lft", name="fnet" )
myeff_m3 <- includeEffects(myeff_m3, egoX, interaction1 = "lft", name="fnet" )
myeff_m3 <- includeEffects(myeff_m3, altX, interaction1 = "lft", name="fnet" )

#myeff_m3 <- includeEffects(myeff_m3, absDiffX , interaction1 = "lft", name="rtnet" )
#myeff_m3 <- includeEffects(myeff_m3, egoX, interaction1 = "lft", name="rtnet" )
myeff_m3 <- includeEffects(myeff_m3, altX, interaction1 = "lft", name="rtnet" )

#myeff_m3 <- includeEffects(myeff_m3, absDiffX , interaction1 = "lft", name="atmnet" )
#myeff_m3 <- includeEffects(myeff_m3, egoX, interaction1 = "lft", name="atmnet" )
#myeff_m3 <- includeEffects(myeff_m3, altX, interaction1 = "lft", name="atmnet" )

myeff_m3 <- includeEffects(myeff_m3, sameX, interaction1 = "ethminz", name="fnet" )
#myeff_m3 <- includeEffects(myeff_m3, egoX, interaction1 = "ethminz", name="fnet" )
#myeff_m3 <- includeEffects(myeff_m3, altX, interaction1 = "ethminz", name="fnet" )

myeff_m3 <- includeEffects(myeff_m3, sameX, interaction1 = "ethminz", name="rtnet" )
myeff_m3 <- includeEffects(myeff_m3, egoX, interaction1 = "ethminz", name="rtnet" )
#myeff_m3 <- includeEffects(myeff_m3, altX, interaction1 = "ethminz", name="rtnet" )

myeff_m3 <- includeEffects(myeff_m3, sameX, interaction1 = "ethminz", name="atmnet" )
#myeff_m3 <- includeEffects(myeff_m3, egoX, interaction1 = "ethminz", name="atmnet" )
#myeff_m3 <- includeEffects(myeff_m3, altX, interaction1 = "ethminz", name="atmnet" )

myeff_m4 <- myeff_m3

myeff_m4 <- includeEffects( myeff_m4, crprod, interaction1="fnet", name="rtnet" )
myeff_m4 <- includeEffects( myeff_m4, crprod, interaction1="fnet", name="atmnet" )
myeff_m4 <- includeEffects( myeff_m4, crprod, interaction1="rtnet", name="fnet" )
myeff_m4 <- includeEffects( myeff_m4, crprod, interaction1="rtnet", name="atmnet" )
#myeff_m4 <- includeEffects( myeff_m4, crprod, interaction1="atmnet", name="fnet" ) #needs to be dropped due to convergence
myeff_m4 <- includeEffects( myeff_m4, crprod, interaction1="atmnet", name="rtnet" )

#ik doe het een, jij doet het ander terug
myeff_m4 <- includeEffects( myeff_m4, crprodRecip, interaction1="fnet", name="rtnet" )
myeff_m4 <- includeEffects( myeff_m4, crprodRecip, interaction1="fnet", name="atmnet" )
myeff_m4 <- includeEffects( myeff_m4, crprodRecip, interaction1="rtnet", name="fnet" )
myeff_m4 <- includeEffects( myeff_m4, crprodRecip, interaction1="rtnet", name="atmnet" )
#myeff_m4 <- includeEffects( myeff_m4, crprodRecip, interaction1="atmnet", name="fnet" ) #needs to be dropped due to convergence
myeff_m4 <- includeEffects( myeff_m4, crprodRecip, interaction1="atmnet", name="rtnet" )
myeff_m4


# Estimation

load("ansM10c.RData") 
ansM10c

myalgorithm <- sienaAlgorithmCreate( projname = 'M11')
ansM11 <- siena07( myalgorithm, data = mydata, prevAns=ansM10c, effects = myeff_m4, useCluster=TRUE, nbrNodes=10, initC=TRUE, batch=TRUE)
ansM11 
save(ansM11, file=paste("ansM11",".RData",sep=""))

ansM11b <- siena07( myalgorithm, data = mydata, prevAns=ansM11, effects = myeff_m4, useCluster=TRUE, nbrNodes=10, initC=TRUE, batch=TRUE)
ansM11b 
save(ansM11b, file=paste("ansM11b",".RData",sep=""))


ansM11c <- siena07( myalgorithm, data = mydata, prevAns=ansM11b, effects = myeff_m4, useCluster=TRUE, nbrNodes=10, initC=TRUE, batch=TRUE)
ansM11c # Overall maximum convergence ratio:    0.2839 
save(ansM11c, file=paste("ansM11c",".RData",sep=""))


# lets trim

# effects

myeff <- getEffects( mydata )
myeff_m1 <- myeff

#according to suggestion of rsiena manual
myeff_m1 <- includeEffects( myeff_m1, inPopSqrt, name="fnet" )
myeff_m1 <- includeEffects( myeff_m1, inPopSqrt, name="atmnet" )
myeff_m1 <- includeEffects( myeff_m1, inPopSqrt, name="rtnet" )

myeff_m1 <- includeEffects( myeff_m1, outActSqrt, name="fnet" )
myeff_m1 <- includeEffects( myeff_m1, outActSqrt, name="atmnet" )
myeff_m1 <- includeEffects( myeff_m1, outActSqrt, name="rtnet" )

myeff_m1 <- includeEffects( myeff_m1, outPopSqrt, name="fnet" )
myeff_m1 <- includeEffects( myeff_m1, outPopSqrt, name="atmnet" )
myeff_m1 <- includeEffects( myeff_m1, outPopSqrt, name="rtnet" )

myeff_m1 <- includeEffects( myeff_m1, transTrip, name="fnet" )
myeff_m1 <- includeEffects( myeff_m1, transTrip, name="atmnet" )
myeff_m1 <- includeEffects( myeff_m1, transTrip, name="rtnet" )

myeff_m1 <- includeEffects( myeff_m1, sharedPop, name="fnet" )
myeff_m1 <- includeEffects( myeff_m1, sharedPop, name="atmnet" )
myeff_m1 <- includeEffects( myeff_m1, sharedPop, name="rtnet" )

myeff_m2 <- myeff_m1

#"kamerlid2016" "pleklijst"    "pleklijst1"

myeff_m2 <- includeEffects( myeff_m2, interaction1="kamerlid2016", altX, name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, interaction1="kamerlid2016", altX, name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, interaction1="kamerlid2016", altX, name="rtnet" )

#myeff_m2 <- includeEffects( myeff_m2, interaction1="kamerlid2016", egoX, name="fnet" )
#myeff_m2 <- setEffect( myeff_m2, interaction1="kamerlid2016", egoX, name="fnet", fix=TRUE, initialValue = -3, test=TRUE )

#myeff_m2 <- includeEffects( myeff_m2, interaction1="kamerlid2016", egoX, name="atmnet" )
myeff_m2 <- includeEffects( myeff_m2, interaction1="kamerlid2016", egoX, name="rtnet" )

myeff_m2 <- includeEffects( myeff_m2, interaction1="kamerlid2016", sameX, name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, interaction1="kamerlid2016", sameX, name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, interaction1="kamerlid2016", sameX, name="rtnet" )

#myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst1", altX, name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst1", altX, name="atmnet" )
myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst1", altX, name="rtnet" )

#myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst1", egoX, name="fnet" )
myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst1", egoX, name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst1", egoX, name="rtnet" )

myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst", egoX, name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst", egoX, name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst", egoX, name="rtnet" )

#myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst", altX, name="fnet" )
myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst", altX, name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst", altX, name="rtnet" )

#these need to be dropped due to collinearity
#myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst", diffX, name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst", diffX, name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst", diffX, name="rtnet" )

#afstand
myeff_m2 <- includeEffects( myeff_m2, X, interaction1="afstand", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, X, interaction1="afstand", name="atmnet" )
myeff_m2 <- includeEffects( myeff_m2, X, interaction1="afstand", name="rtnet" )



myeff_m2 <- includeEffects(myeff_m2, sameX, interaction1 = "partij", name="fnet" )

#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "cda", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "cu", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "denk", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "d66", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "fvd", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "gl", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "pvda", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "pvdd", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "pvv", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "sgp", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "sp", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "vvd", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "plus", name="fnet" )

#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "cda", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "cu", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "denk", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "d66", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "fvd", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "gl", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "pvda", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "pvdd", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "pvv", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "sgp", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "sp", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "vvd", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "plus", name="fnet" )

myeff_m2 <- includeEffects(myeff_m2, sameX, interaction1 = "partij", name="atmnet" )

#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "cda", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "cu", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "denk", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "d66", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "fvd", name="atmnet" )
myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "gl", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "pvda", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "pvdd", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "pvv", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "sgp", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "sp", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "vvd", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "plus", name="atmnet" )

#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "cda", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "cu", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "denk", name="atmnet" )
myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "d66", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "fvd", name="atmnet" )
myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "gl", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "pvda", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "pvdd", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "pvv", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "sgp", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "sp", name="atmnet" )
# myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "vvd", name="atmnet" ) #referentie
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "plus", name="atmnet" )

myeff_m2 <- includeEffects(myeff_m2, sameX, interaction1 = "partij", name="rtnet" )

#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "cda", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "cu", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "denk", name="rtnet" )
myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "d66", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "fvd", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "gl", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "pvda", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "pvdd", name="rtnet" )
myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "pvv", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "sgp", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "sp", name="rtnet" )
# myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "vvd", name="rtnet" ) #referentie
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "plus", name="rtnet" )

#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "cda", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "cu", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "denk", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "d66", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "fvd", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "gl", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "pvda", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "pvdd", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "pvv", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "sgp", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "sp", name="rtnet" )
# myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "vvd", name="rtnet" ) #referentie
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "plus", name="rtnet" )

myeff_m3 <- myeff_m2

myeff_m3 <- includeEffects(myeff_m3, sameX, interaction1 = "vrouw", name="fnet" )
#myeff_m3 <- includeEffects(myeff_m3, egoX, interaction1 = "vrouw", name="fnet" )
myeff_m3 <- includeEffects(myeff_m3, altX, interaction1 = "vrouw", name="fnet" )

myeff_m3 <- includeEffects(myeff_m3, sameX, interaction1 = "vrouw", name="rtnet" )
myeff_m3 <- includeEffects(myeff_m3, egoX, interaction1 = "vrouw", name="rtnet" )
myeff_m3 <- includeEffects(myeff_m3, altX, interaction1 = "vrouw", name="rtnet" )

#myeff_m3 <- includeEffects(myeff_m3, sameX, interaction1 = "vrouw", name="atmnet" )
#myeff_m3 <- includeEffects(myeff_m3, egoX, interaction1 = "vrouw", name="atmnet" )
#myeff_m3 <- includeEffects(myeff_m3, altX, interaction1 = "vrouw", name="atmnet" )

myeff_m3 <- includeEffects(myeff_m3, absDiffX , interaction1 = "lft", name="fnet" )
myeff_m3 <- includeEffects(myeff_m3, egoX, interaction1 = "lft", name="fnet" )
myeff_m3 <- includeEffects(myeff_m3, altX, interaction1 = "lft", name="fnet" )

#myeff_m3 <- includeEffects(myeff_m3, absDiffX , interaction1 = "lft", name="rtnet" )
#myeff_m3 <- includeEffects(myeff_m3, egoX, interaction1 = "lft", name="rtnet" )
myeff_m3 <- includeEffects(myeff_m3, altX, interaction1 = "lft", name="rtnet" )

#myeff_m3 <- includeEffects(myeff_m3, absDiffX , interaction1 = "lft", name="atmnet" )
#myeff_m3 <- includeEffects(myeff_m3, egoX, interaction1 = "lft", name="atmnet" )
#myeff_m3 <- includeEffects(myeff_m3, altX, interaction1 = "lft", name="atmnet" )

myeff_m3 <- includeEffects(myeff_m3, sameX, interaction1 = "ethminz", name="fnet" )
#myeff_m3 <- includeEffects(myeff_m3, egoX, interaction1 = "ethminz", name="fnet" )
#myeff_m3 <- includeEffects(myeff_m3, altX, interaction1 = "ethminz", name="fnet" )

myeff_m3 <- includeEffects(myeff_m3, sameX, interaction1 = "ethminz", name="rtnet" )
myeff_m3 <- includeEffects(myeff_m3, egoX, interaction1 = "ethminz", name="rtnet" )
#myeff_m3 <- includeEffects(myeff_m3, altX, interaction1 = "ethminz", name="rtnet" )

#myeff_m3 <- includeEffects(myeff_m3, sameX, interaction1 = "ethminz", name="atmnet" )
#myeff_m3 <- includeEffects(myeff_m3, egoX, interaction1 = "ethminz", name="atmnet" )
#myeff_m3 <- includeEffects(myeff_m3, altX, interaction1 = "ethminz", name="atmnet" )

myeff_m4 <- myeff_m3

myeff_m4 <- includeEffects( myeff_m4, crprod, interaction1="fnet", name="rtnet" )
myeff_m4 <- includeEffects( myeff_m4, crprod, interaction1="fnet", name="atmnet" )
myeff_m4 <- includeEffects( myeff_m4, crprod, interaction1="rtnet", name="fnet" )
myeff_m4 <- includeEffects( myeff_m4, crprod, interaction1="rtnet", name="atmnet" )
#myeff_m4 <- includeEffects( myeff_m4, crprod, interaction1="atmnet", name="fnet" ) #needs to be dropped due to convergence
myeff_m4 <- includeEffects( myeff_m4, crprod, interaction1="atmnet", name="rtnet" )

#ik doe het een, jij doet het ander terug
myeff_m4 <- includeEffects( myeff_m4, crprodRecip, interaction1="fnet", name="rtnet" )
myeff_m4 <- includeEffects( myeff_m4, crprodRecip, interaction1="fnet", name="atmnet" )
myeff_m4 <- includeEffects( myeff_m4, crprodRecip, interaction1="rtnet", name="fnet" )
myeff_m4 <- includeEffects( myeff_m4, crprodRecip, interaction1="rtnet", name="atmnet" )
#myeff_m4 <- includeEffects( myeff_m4, crprodRecip, interaction1="atmnet", name="fnet" ) #needs to be dropped due to convergence
myeff_m4 <- includeEffects( myeff_m4, crprodRecip, interaction1="atmnet", name="rtnet" )
myeff_m4

# estimates

load("ansM11c.RData") 
ansM11c

myalgorithm <- sienaAlgorithmCreate( projname = 'M12')
ansM12 <- siena07( myalgorithm, data = mydata, prevAns=ansM11c, effects = myeff_m4, useCluster=TRUE, nbrNodes=10, initC=TRUE, batch=TRUE)
ansM12 # Overall maximum convergence ratio:    0.2562 
save(ansM12, file=paste("ansM12",".RData",sep=""))

ansM12b <- siena07( myalgorithm, data = mydata, prevAns=ansM12, effects = myeff_m4, useCluster=TRUE, nbrNodes=10, initC=TRUE, batch=TRUE)
ansM12b # Overall maximum convergence ratio:    0.3631 


save(ansM12b, file=paste("ansM12b",".RData",sep=""))


ansM12c <- siena07( myalgorithm, data = mydata, prevAns=ansM12b, effects = myeff_m4, useCluster=TRUE, nbrNodes=10, initC=TRUE, batch=TRUE)
ansM12c #Overall maximum convergence ratio:    0.2951 

save(ansM12c, file=paste("ansM12c",".RData",sep=""))




```

```{r, eval=TRUE}
load("ansM12.RData")

ansM12

#xtable.sienaFit(ansM12, file="ansM12.html", type="html", digits=3)

```

---  

## Model 4 {.tabset .tabset-fade}

Here we test Hypothesis 5 on time trends in the impact of the same-party variable. 

### sienaTimeTest 

```{r, echo=TRUE, eval=TRUE}
load("ansM8c.RData")


tt <- sienaTimeTest(ansM8c,  effects=c(11,24,41))
#tt
#tt$EffectTest
#tt$IndividualTest
plot(tt)

```

### Model 4 - final {.active}
```{r, echo=TRUE}

myeff_t <- myeff_m2

myeff_t <- includeTimeDummy(myeff_t, sameX, interaction1 = "partij", name="fnet", timeDummy="2")
myeff_t <- includeTimeDummy(myeff_t, sameX, interaction1 = "partij", name="atmnet", timeDummy="2")
myeff_t <- includeTimeDummy(myeff_t, sameX, interaction1 = "partij", name="rtnet", timeDummy="2")
myeff_t

myalgorithm <- sienaAlgorithmCreate( projname = 'M8c_t', nsub=5, n3=5000 )
ansM8c_t <- siena07( myalgorithm, data = mydata, prevAns=ansM8c, effects = myeff_t, useCluster=TRUE, nbrNodes=10, initC=TRUE, batch=TRUE)
ansM8c_t 
save(ansM8c_t, file=paste("ansM8c_t",".RData",sep=""))
``` 

```{r, echo=TRUE, eval=TRUE}

load("ansM8c_t.RData")	
#xtable.sienaFit(ansM8c_t, file="ansM8c_t.html", type="html", digits=3)


res <- round(fanscsv(ansM8c_t)[c(11,16,26,34,45,53), 1:2],5)

mc <- as.character(round(fanscsv(ansM8c_t)[54,1],3))

row.names(res) <- c(
 "same party (dyad)"  ,      
 "time*same party"   ,     
 "same party (dyad)"  ,      
 "time*same party"   ,     
 "same party (dyad)"  ,      
 "time*same party"   
)
  
M4 <- kbl(res, booktabs=TRUE, digits=3, caption="Model 4", align = "c") %>%
  kable_classic(full_width = F, html_font = "Cambria") %>%
  kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive")) %>%
  column_spec(column = 1, width = "3in")   %>%
  #row_spec(c(11, 24,41), bold = T, color = "white", background = "#D7261E") %>%
  group_rows(index = c("Following" = 2, "Atmention" = 2, "Retweets" = 2)) %>%
  footnote(general = paste("Overall maximum convergence ratio: ", mc, sep="" ))


M4


```

---  

## Model RR {.tabset .tabset-fade}

An anonymous reviewer suggested to try to disentangle the impact of physical seating distance from ideological distance. We therefore added to the party to which each MP belongs a general left-right position according to the Chapel Hill Survey [@jolly2022chapel]. 

### Load data objects 


Data objects:  

- [key](./data-processed/key moederbestand 20171114.sav): information on all politicians on election list  
- [twitter](./data-processed/twitter_20190919.RData)  
    - keyf: information on all 147 MPs with twitter handle  
    - mydata: RSiena object with all kind of goodies inside  
    - seats: seating coordinates of HoP (used for plotting)  
- [CHES](https://www.chesdata.eu/ches-europe): information on party positions see also [@jolly2022chapel]


```{r, eval=TRUE}
library(haven)
ches <- read_dta("./data-raw/CHES_means_2017.dta")
ches <- as.data.frame(ches)
ches <- ches[ches$country==10,]
```


As the ideological position of parties was not included in our original data object we need to fix that. 

```{r data2, echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
#STAP 1: read in data
key <- read.spss('data-processed\\key moederbestand 20171114.sav', use.value.labels=T, to.data.frame=T)


load("data-processed\\twitter_20190919.RData")
#str(twitter_20190919,1)
keyf <- twitter_20190919[[1]]
mydata <- twitter_20190919[[2]]
seats <- twitter_20190919[[3]]

ches$Partij <- ches$party

keyf <- left_join(keyf, ches)



#deconstruct dataobject
deps <- mydata$depvars
covariates <- mydata$cCovars
codyadcovar <- mydata$dycCovars

fnet <- sienaNet(deps$fnet) 
atmnet <- sienaNet(deps$atmnet)
rtnet <- sienaNet(deps$rtnet)
afstand <- codyadcovar$afstand
egohandle <- covariates$egohandle
egoid <- covariates$egoid
partij <- covariates$partij
coalitie <- covariates$coalitie
cda <- covariates$cda
cu <- covariates$cu
denk <- covariates$denk
d66 <- covariates$d66
fvd <- covariates$fvd
gl <- covariates$gl
pvda <- covariates$pvda
pvdd <- covariates$pvdd
pvv <- covariates$pvv
sgp <- covariates$sgp
sp <- covariates$sp
vvd <- covariates$vvd
plus <- covariates$plus
ethminz <- covariates$ethminz
vrouw <- covariates$vrouw
lft <- covariates$lft
kamerlid2016 <- covariates$kamerlid2016
kabinet2016 <- covariates$kabinet2016
pleklijst <- covariates$pleklijst
pleklijst1 <- covariates$pleklijst1
#add new variable
partypos <- coCovar(keyf$lrgen)  

#reconstruct dataobject
mydata_RR <- sienaDataCreate(fnet,
                          atmnet, 
                          rtnet, 
                          afstand, 
                          egohandle, 
                          egoid, 
                          partij, 
                          coalitie, 
                          cda,
                          cu,
                          denk,
                          d66,
                          fvd,
                          gl,
                          pvda,
                          pvdd,
                          pvv,
                          sgp,
                          sp,
                          vvd,
                          plus, 
                          ethminz,
                          vrouw,
                          lft,
                          kamerlid2016,
                          kabinet2016,
                          pleklijst,
                          pleklijst1,
                          partypos)


```



### Define effects  

```{r echo=TRUE, eval=TRUE, results='hide'}
myeff <- getEffects( mydata_RR )
myeff_m1 <- myeff

#according to suggestion of rsiena manual
myeff_m1 <- includeEffects( myeff_m1, inPopSqrt, name="fnet" )
myeff_m1 <- includeEffects( myeff_m1, inPopSqrt, name="atmnet" )
myeff_m1 <- includeEffects( myeff_m1, inPopSqrt, name="rtnet" )

myeff_m1 <- includeEffects( myeff_m1, outActSqrt, name="fnet" )
myeff_m1 <- includeEffects( myeff_m1, outActSqrt, name="atmnet" )
myeff_m1 <- includeEffects( myeff_m1, outActSqrt, name="rtnet" )

myeff_m1 <- includeEffects( myeff_m1, outPopSqrt, name="fnet" )
myeff_m1 <- includeEffects( myeff_m1, outPopSqrt, name="atmnet" )
myeff_m1 <- includeEffects( myeff_m1, outPopSqrt, name="rtnet" )

myeff_m1 <- includeEffects( myeff_m1, transTrip, name="fnet" )
myeff_m1 <- includeEffects( myeff_m1, transTrip, name="atmnet" )
myeff_m1 <- includeEffects( myeff_m1, transTrip, name="rtnet" )

myeff_m1 <- includeEffects( myeff_m1, sharedPop, name="fnet" )
myeff_m1 <- includeEffects( myeff_m1, sharedPop, name="atmnet" )
myeff_m1 <- includeEffects( myeff_m1, sharedPop, name="rtnet" )

myeff_m2 <- myeff_m1

#"kamerlid2016" "pleklijst"    "pleklijst1"

myeff_m2 <- includeEffects( myeff_m2, interaction1="kamerlid2016", altX, name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, interaction1="kamerlid2016", altX, name="atmnet" )
myeff_m2 <- includeEffects( myeff_m2, interaction1="kamerlid2016", altX, name="rtnet" )

#myeff_m2 <- includeEffects( myeff_m2, interaction1="kamerlid2016", egoX, name="fnet" )
#myeff_m2 <- setEffect( myeff_m2, interaction1="kamerlid2016", egoX, name="fnet", fix=TRUE, initialValue = -3, test=TRUE )

#myeff_m2 <- includeEffects( myeff_m2, interaction1="kamerlid2016", egoX, name="atmnet" )
myeff_m2 <- includeEffects( myeff_m2, interaction1="kamerlid2016", egoX, name="rtnet" )

myeff_m2 <- includeEffects( myeff_m2, interaction1="kamerlid2016", sameX, name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, interaction1="kamerlid2016", sameX, name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, interaction1="kamerlid2016", sameX, name="rtnet" )

#myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst1", altX, name="fnet" )
myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst1", altX, name="atmnet" )
myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst1", altX, name="rtnet" )

#myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst1", egoX, name="fnet" )
myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst1", egoX, name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst1", egoX, name="rtnet" )

myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst", egoX, name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst", egoX, name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst", egoX, name="rtnet" )

#myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst", altX, name="fnet" )
myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst", altX, name="atmnet" )
myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst", altX, name="rtnet" )

#these need to be dropped due to collinearity
#myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst", diffX, name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst", diffX, name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst", diffX, name="rtnet" )

#afstand
myeff_m2 <- includeEffects( myeff_m2, X, interaction1="afstand", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, X, interaction1="afstand", name="atmnet" )
myeff_m2 <- includeEffects( myeff_m2, X, interaction1="afstand", name="rtnet" )



myeff_m2 <- includeEffects(myeff_m2, sameX, interaction1 = "partij", name="fnet" )

#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "cda", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "cu", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "denk", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "d66", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "fvd", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "gl", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "pvda", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "pvdd", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "pvv", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "sgp", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "sp", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "vvd", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "plus", name="fnet" )

#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "cda", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "cu", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "denk", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "d66", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "fvd", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "gl", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "pvda", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "pvdd", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "pvv", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "sgp", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "sp", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "vvd", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "plus", name="fnet" )

myeff_m2 <- includeEffects(myeff_m2, sameX, interaction1 = "partij", name="atmnet" )

#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "cda", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "cu", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "denk", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "d66", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "fvd", name="atmnet" )
myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "gl", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "pvda", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "pvdd", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "pvv", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "sgp", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "sp", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "vvd", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "plus", name="atmnet" )

#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "cda", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "cu", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "denk", name="atmnet" )
myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "d66", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "fvd", name="atmnet" )
myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "gl", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "pvda", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "pvdd", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "pvv", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "sgp", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "sp", name="atmnet" )
# myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "vvd", name="atmnet" ) #referentie
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "plus", name="atmnet" )

myeff_m2 <- includeEffects(myeff_m2, sameX, interaction1 = "partij", name="rtnet" )

#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "cda", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "cu", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "denk", name="rtnet" )
myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "d66", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "fvd", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "gl", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "pvda", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "pvdd", name="rtnet" )
myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "pvv", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "sgp", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "sp", name="rtnet" )
# myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "vvd", name="rtnet" ) #referentie
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "plus", name="rtnet" )

#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "cda", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "cu", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "denk", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "d66", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "fvd", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "gl", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "pvda", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "pvdd", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "pvv", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "sgp", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "sp", name="rtnet" )
# myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "vvd", name="rtnet" ) #referentie
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "plus", name="rtnet" )

myeff_RR <- myeff_m2
myeff_RR <- includeEffects(myeff_RR, interaction1="partypos", absDiffX, name="fnet" )
myeff_RR <- includeEffects(myeff_RR, interaction1="partypos", absDiffX, name="rtnet" )
```


```{r echo=TRUE, eval=TRUE}
myeff_RR
```

### estimate model

```{r, echo=TRUE, eval=FALSE}
myalgorithmRR <- sienaAlgorithmCreate( projname = 'RR')

ansRR1 <- siena07( myalgorithmRR, data = mydata_RR, prevAns=ansM8c, effects = myeff_RR, useCluster=TRUE, nbrNodes=8, initC=TRUE, batch=TRUE)

#save(ansRR1, file=paste("ansRR1",".RData",sep=""))
```

### Model RR - final  {.active}

The parameters of interest are in red. 


```{r, echo=TRUE, eval=TRUE}
load("ansRR1.RData")


res <- round(fanscsv(ansRR1)[,1:2],5)
mcpos <- length(res[,1])
res <- res[-mcpos,]
mc <- as.character(round(fanscsv(ansRR1)[mcpos,1],3))
row.names(res) <- c(
 "rate 1"  ,      
 "rate 2"   ,     
 "outdegree"          ,  
 "reciprocity"         ,           
 "transitive triplets"  ,          
 "shared popularity"     ,         
 "indegree - popularity"   ,
  " outdegree - popularity" , 
 "outdegree - activity"    ,
 "seating distance (dyad)"         ,               
 "same party (dyad)"                ,    
"incumbancy status (alter)"          ,   
"same incumbancy status (dyad)"       ,       
"position on election list (ego)"      ,
"ideological distance (dyad)" ,
 "rate 1"      ,
 "rate 2"      ,
"outdegree"          ,
 "reciprocity"        ,          
 "transitive triplets" ,         
 "shared popularity"    ,        
 "indegree - popularity" ,
 "outdegree - popularity",
"outdegree - activity "  ,
 "same party (dyad)"            ,      
"party Liberal Democrats (alter)",                    
"party GreenLeft (alter)"         ,            
 "party GreenLeft (ego)"           ,            
 "position on election list (alter)",              
"party leader (alter)"             ,
 "party leader (ego)"               ,
 "rate 1"       ,
 "rate 2"       ,
"outdegree"           ,
"reciprocity"          ,         
"transitive triplets"   ,        
"shared popularity"      ,       
"indegree - popularity ",  
"outdegree - popularity", 
"outdegree - activity "   ,
"seating distance (dyad)"        ,               
 "same party (dyad)"              ,     
 "party Liberal Democrats (ego)"   ,                    
 "party Freedom Party (ego)"        ,               
 "incumbancy status (alter)"         ,   
 "incumbancy status (ego)"            ,  
 "position on election list (alter)"   ,            
"party leader (alter)", 
 "ideological distance (dyad)"
)
  
RR1 <- kbl(res, booktabs=TRUE, digits=3, caption="Model RR: including ideological distance", align = "c") %>%
  kable_classic(full_width = F, html_font = "Cambria") %>%
  kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive")) %>%
  column_spec(column = 1, width = "3in")   %>%
  row_spec(c(10, 15,41,49), bold = T, color = "white", background = "#D7261E") %>%
  group_rows(index = c("Following" = 15, "Atmention" = 16, "Retweets" = 18)) %>%
  footnote(general = paste("Overall maximum convergence ratio: ", mc, sep="" ))


RR1

```

---  



---  


## Model RR2 {.tabset .tabset-fade}

An anonymous reviewer argued that the last candidate elected from each party election list may posses “a heightened interest in active social network engagement to promote themselves or, conversely, aim to develop an individual discourse to bolster their political careers beyond the current legislative term” and suggested to assess the extent to which the same-party effect (party based similarity preferences) would be different for these specific MPs.  

### Load data objects 


Data objects:  

- [key](./data-processed/key moederbestand 20171114.sav): information on all politicians on election list  
- [twitter](./data-processed/twitter_20190919.RData)  
    - keyf: information on all 147 MPs with twitter handle  
    - mydata: RSiena object with all kind of goodies inside  
    - seats: seating coordinates of HoP (used for plotting)  
- [CHES](https://www.chesdata.eu/ches-europe): information on party positions see also [@jolly2022chapel]


```{r data2, echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
#STAP 1: read in data
library(haven)
ches <- read_dta("./data-raw/CHES_means_2017.dta")
ches <- as.data.frame(ches)
ches <- ches[ches$country==10,]


key <- read.spss('data-processed\\key moederbestand 20171114.sav', use.value.labels=T, to.data.frame=T)


load("data-processed\\twitter_20190919.RData")
#str(twitter_20190919,1)
keyf <- twitter_20190919[[1]]
mydata <- twitter_20190919[[2]]
seats <- twitter_20190919[[3]]

keyf %>% group_by(Partij) %>%
  summarise(maxlist = max(PlekLijst), #note there are MPs with preference votes. 
            nseats = n()) -> keyf_temp

#correct for three missing MPs. 
keyf_temp$nseats[keyf_temp$Partij=="VVD"] <-  keyf_temp$nseats[keyf_temp$Partij=="VVD"] + 1
keyf_temp$nseats[keyf_temp$Partij=="PVV"] <-  keyf_temp$nseats[keyf_temp$Partij=="PVV"] + 2

keyf <- left_join(keyf, keyf_temp)

keyf$lastlist <- ifelse(keyf$PlekLijst>=keyf$nseats, 1, 0) 

ches$Partij <- ches$party

keyf <- left_join(keyf, ches)



#deconstruct dataobject
deps <- mydata$depvars
covariates <- mydata$cCovars
codyadcovar <- mydata$dycCovars

fnet <- sienaNet(deps$fnet) 
atmnet <- sienaNet(deps$atmnet)
rtnet <- sienaNet(deps$rtnet)
afstand <- codyadcovar$afstand
egohandle <- covariates$egohandle
egoid <- covariates$egoid
partij <- covariates$partij
coalitie <- covariates$coalitie
cda <- covariates$cda
cu <- covariates$cu
denk <- covariates$denk
d66 <- covariates$d66
fvd <- covariates$fvd
gl <- covariates$gl
pvda <- covariates$pvda
pvdd <- covariates$pvdd
pvv <- covariates$pvv
sgp <- covariates$sgp
sp <- covariates$sp
vvd <- covariates$vvd
plus <- covariates$plus
ethminz <- covariates$ethminz
vrouw <- covariates$vrouw
lft <- covariates$lft
kamerlid2016 <- covariates$kamerlid2016
kabinet2016 <- covariates$kabinet2016
pleklijst <- covariates$pleklijst
pleklijst1 <- covariates$pleklijst1
#add new variables
partypos <- coCovar(keyf$lrgen)  
lastlist <- coCovar(keyf$lastlist)
nseats <- coCovar(keyf$nseats)

table(coalitie, partij)

#reconstruct dataobject
mydata_RR2 <- sienaDataCreate(fnet,
                          atmnet, 
                          rtnet, 
                          afstand, 
                          egohandle, 
                          egoid, 
                          partij, 
                          coalitie, 
                          cda,
                          cu,
                          denk,
                          d66,
                          fvd,
                          gl,
                          pvda,
                          pvdd,
                          pvv,
                          sgp,
                          sp,
                          vvd,
                          plus, 
                          ethminz,
                          vrouw,
                          lft,
                          kamerlid2016,
                          kabinet2016,
                          pleklijst,
                          pleklijst1,
                          partypos, 
                          lastlist,
                          nseats)

```



### Define effects  

#### Interaction 'same party' with 'last on list'. 

```{r echo=TRUE, eval=TRUE, results='hide'}
myeff <- getEffects( mydata_RR2 )
myeff_m1 <- myeff

#according to suggestion of rsiena manual
myeff_m1 <- includeEffects( myeff_m1, inPopSqrt, name="fnet" )
myeff_m1 <- includeEffects( myeff_m1, inPopSqrt, name="atmnet" )
myeff_m1 <- includeEffects( myeff_m1, inPopSqrt, name="rtnet" )

myeff_m1 <- includeEffects( myeff_m1, outActSqrt, name="fnet" )
myeff_m1 <- includeEffects( myeff_m1, outActSqrt, name="atmnet" )
myeff_m1 <- includeEffects( myeff_m1, outActSqrt, name="rtnet" )

myeff_m1 <- includeEffects( myeff_m1, outPopSqrt, name="fnet" )
myeff_m1 <- includeEffects( myeff_m1, outPopSqrt, name="atmnet" )
myeff_m1 <- includeEffects( myeff_m1, outPopSqrt, name="rtnet" )

myeff_m1 <- includeEffects( myeff_m1, transTrip, name="fnet" )
myeff_m1 <- includeEffects( myeff_m1, transTrip, name="atmnet" )
myeff_m1 <- includeEffects( myeff_m1, transTrip, name="rtnet" )

myeff_m1 <- includeEffects( myeff_m1, sharedPop, name="fnet" )
myeff_m1 <- includeEffects( myeff_m1, sharedPop, name="atmnet" )
myeff_m1 <- includeEffects( myeff_m1, sharedPop, name="rtnet" )

myeff_m2 <- myeff_m1

#"kamerlid2016" "pleklijst"    "pleklijst1"

myeff_m2 <- includeEffects( myeff_m2, interaction1="kamerlid2016", altX, name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, interaction1="kamerlid2016", altX, name="atmnet" )
myeff_m2 <- includeEffects( myeff_m2, interaction1="kamerlid2016", altX, name="rtnet" )

#myeff_m2 <- includeEffects( myeff_m2, interaction1="kamerlid2016", egoX, name="fnet" )
#myeff_m2 <- setEffect( myeff_m2, interaction1="kamerlid2016", egoX, name="fnet", fix=TRUE, initialValue = -3, test=TRUE )

#myeff_m2 <- includeEffects( myeff_m2, interaction1="kamerlid2016", egoX, name="atmnet" )
myeff_m2 <- includeEffects( myeff_m2, interaction1="kamerlid2016", egoX, name="rtnet" )

myeff_m2 <- includeEffects( myeff_m2, interaction1="kamerlid2016", sameX, name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, interaction1="kamerlid2016", sameX, name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, interaction1="kamerlid2016", sameX, name="rtnet" )

#myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst1", altX, name="fnet" )
myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst1", altX, name="atmnet" )
myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst1", altX, name="rtnet" )

#myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst1", egoX, name="fnet" )
myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst1", egoX, name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst1", egoX, name="rtnet" )

myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst", egoX, name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst", egoX, name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst", egoX, name="rtnet" )

#myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst", altX, name="fnet" )
myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst", altX, name="atmnet" )
myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst", altX, name="rtnet" )

#these need to be dropped due to collinearity
#myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst", diffX, name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst", diffX, name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, interaction1="pleklijst", diffX, name="rtnet" )

#afstand
myeff_m2 <- includeEffects( myeff_m2, X, interaction1="afstand", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, X, interaction1="afstand", name="atmnet" )
myeff_m2 <- includeEffects( myeff_m2, X, interaction1="afstand", name="rtnet" )



myeff_m2 <- includeEffects(myeff_m2, sameX, interaction1 = "partij", name="fnet" )

#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "cda", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "cu", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "denk", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "d66", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "fvd", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "gl", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "pvda", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "pvdd", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "pvv", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "sgp", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "sp", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "vvd", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "plus", name="fnet" )

#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "cda", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "cu", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "denk", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "d66", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "fvd", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "gl", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "pvda", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "pvdd", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "pvv", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "sgp", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "sp", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "vvd", name="fnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "plus", name="fnet" )

myeff_m2 <- includeEffects(myeff_m2, sameX, interaction1 = "partij", name="atmnet" )

#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "cda", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "cu", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "denk", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "d66", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "fvd", name="atmnet" )
myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "gl", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "pvda", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "pvdd", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "pvv", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "sgp", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "sp", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "vvd", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "plus", name="atmnet" )

#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "cda", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "cu", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "denk", name="atmnet" )
myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "d66", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "fvd", name="atmnet" )
myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "gl", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "pvda", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "pvdd", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "pvv", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "sgp", name="atmnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "sp", name="atmnet" )
# myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "vvd", name="atmnet" ) #referentie
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "plus", name="atmnet" )

myeff_m2 <- includeEffects(myeff_m2, sameX, interaction1 = "partij", name="rtnet" )

#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "cda", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "cu", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "denk", name="rtnet" )
myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "d66", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "fvd", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "gl", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "pvda", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "pvdd", name="rtnet" )
myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "pvv", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "sgp", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "sp", name="rtnet" )
# myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "vvd", name="rtnet" ) #referentie
#myeff_m2 <- includeEffects( myeff_m2, egoX, interaction1 = "plus", name="rtnet" )

#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "cda", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "cu", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "denk", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "d66", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "fvd", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "gl", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "pvda", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "pvdd", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "pvv", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "sgp", name="rtnet" )
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "sp", name="rtnet" )
# myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "vvd", name="rtnet" ) #referentie
#myeff_m2 <- includeEffects( myeff_m2, altX, interaction1 = "plus", name="rtnet" )

myeff_RR <- myeff_m2
myeff_RR <- includeEffects(myeff_RR, interaction1="partypos", absDiffX, name="fnet" )
myeff_RR <- includeEffects(myeff_RR, interaction1="partypos", absDiffX, name="rtnet" )

# Interaction same party with last on list. 

myeff_RR2_I1 <- myeff_RR
myeff_RR2_I1 <- includeEffects(myeff_RR2_I1, egoX, interaction1=c("lastlist"), name="fnet" )
myeff_RR2_I1 <- includeInteraction(myeff_RR2_I1, egoX, sameX, interaction1=c("lastlist", "partij"), name="fnet" )

myeff_RR2_I1 <- includeEffects(myeff_RR2_I1, egoX, interaction1=c("lastlist"), name="rtnet" )
myeff_RR2_I1 <- includeInteraction(myeff_RR2_I1, egoX, sameX, interaction1=c("lastlist", "partij"), name="rtnet" )

myeff_RR2_I1 <- includeEffects(myeff_RR2_I1, egoX, interaction1=c("lastlist"), name="atmnet" )
myeff_RR2_I1 <- includeInteraction(myeff_RR2_I1, egoX, sameX, interaction1=c("lastlist", "partij"), name="atmnet" )

```


```{r echo=TRUE, eval=TRUE}
myeff_RR2_I1
```

### estimate model

```{r, echo=TRUE, eval=FALSE}
myalgorithmRR2 <- sienaAlgorithmCreate( projname = 'RR2')

ansRR2_I1 <- siena07( myalgorithmRR2, data = mydata_RR2, effects = myeff_RR2_I1, useCluster=TRUE, nbrNodes=12, initC=TRUE, batch=TRUE)

save(ansRR2_I1, file=paste("ansRR2_I1",".RData",sep=""))
```

### Model RR2 - final  {.active}

The parameters of interest are in red. 

Please note, SE are large and that the overall convergence ratio is unsatisfactory. But these results do not provide clear corroborative evidence that the impact of the same-party effect is conditional on whether an MP holds the highest position on the specific election list. 

```{r, echo=TRUE, eval=TRUE}
load("ansRR2_I1.RData")


res <- round(fanscsv(ansRR2_I1)[,1:2],5)
mcpos <- length(res[,1])
res <- res[-mcpos,]
mc <- as.character(round(fanscsv(ansRR2_I1)[mcpos,1],3))
row.names(res) <- c(
 "rate 1"  ,      
 "rate 2"   ,     
 "outdegree"          ,  
 "reciprocity"         ,           
 "transitive triplets"  ,          
 "shared popularity"     ,         
 "indegree - popularity"   ,
  " outdegree - popularity" , 
 "outdegree - activity"    ,
 "seating distance (dyad)"         ,               
 "same party (dyad)"                ,    
"incumbancy status (alter)"          ,   
"same incumbancy status (dyad)"       ,       
"position on election list (ego)"      ,
"ideological distance (dyad)" ,
"last on election list",
"last on election list * same party",
 "rate 1"      ,
 "rate 2"      ,
"outdegree"          ,
 "reciprocity"        ,          
 "transitive triplets" ,         
 "shared popularity"    ,        
 "indegree - popularity" ,
 "outdegree - popularity",
"outdegree - activity "  ,
 "same party (dyad)"            ,      
"party Liberal Democrats (alter)",                    
"party GreenLeft (alter)"         ,            
 "party GreenLeft (ego)"           ,            
 "position on election list (alter)",              
"party leader (alter)"             ,
 "party leader (ego)"               ,
"last on election list",
"last on election list * same party",
 "rate 1"       ,
 "rate 2"       ,
"outdegree"           ,
"reciprocity"          ,         
"transitive triplets"   ,        
"shared popularity"      ,       
"indegree - popularity ",  
"outdegree - popularity", 
"outdegree - activity "   ,
"seating distance (dyad)"        ,               
 "same party (dyad)"              ,     
 "party Liberal Democrats (ego)"   ,                    
 "party Freedom Party (ego)"        ,               
 "incumbancy status (alter)"         ,   
 "incumbancy status (ego)"            ,  
 "position on election list (alter)"   ,            
"party leader (alter)", 
 "ideological distance (dyad)",
"last on election list",
"last on election list * same party"
)
  
RR2 <- kbl(res, booktabs=TRUE, digits=3, caption="Model RR2: including 'last on election list * same party'", align = "c") %>%
  kable_classic(full_width = F, html_font = "Cambria") %>%
  kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive")) %>%
  column_spec(column = 1, width = "3in")   %>%
  row_spec(c(16,17, 34,35,54,55), bold = T, color = "white", background = "#D7261E") %>%
  group_rows(index = c("Following" = 17, "Atmention" = 18, "Retweets" = 20)) %>%
  footnote(general = paste("Overall maximum convergence ratio: ", mc, sep="" ))


RR2

```

---  

  




# Hypothesis 3 {.tabset .tabset-fade} 

## Based on Model 1 

Test for significance of the difference in party-based segregation in the three Twitter layers based on Model 1. 

Hypothesis 3a: Segregation in atmention is larger than in follow. No because...

```{r, echo=TRUE, eval=TRUE, results='hold'}
load("ansM8c.RData")
ans <- ansM8c
p <- ans$pp

## segregation in atmention is larger than in follow
mat <- matrix(0,1,p)
mat[1,24] <- -1
mat[1,11] <- 1
Wald.RSiena(mat, ans)

dif <- sum(mat * ans$theta)
se <- sqrt(mat %*% ans$covtheta %*% t(mat))

print(paste("difference is", round(dif,3), "with s.e.", round(se, 3), ", t-ratio", round(dif/se, 3)))


```

Hypothesis 3b: Segregation in follow is larger than in retweet. No because...

```{r, echo=TRUE, eval=TRUE, results='hold'}
ans <- ansM8c
p <- ans$pp

## segregation in atmention is larger than in follow
mat <- matrix(0,1,p)
mat[1,11] <- -1
mat[1,41] <- 1
Wald.RSiena(mat, ans)

dif <- sum(mat * ans$theta)
se <- sqrt(mat %*% ans$covtheta %*% t(mat))

print(paste("difference is", round(dif,3), "with s.e.", round(se, 3), ", t-ratio", round(dif/se, 3)))

```

Segregation in atmention is larger than in retweet. Yes, because...

```{r, echo=TRUE, eval=TRUE, results='hold'}
ans <- ansM8c
p <- ans$pp

## segregation in atmention is larger than in follow
mat <- matrix(0,1,p)
mat[1,24] <- -1
mat[1,41] <- 1
Wald.RSiena(mat, ans)

dif <- sum(mat * ans$theta)
se <- sqrt(mat %*% ans$covtheta %*% t(mat))

print(paste("difference is", round(dif,3), "with s.e.", round(se, 3), ", t-ratio", round(dif/se, 3)))

```

---  

## Based on Model 2 

Hypothesis 3a: Segregation in atmention is larger than in follow. No because...

```{r, echo=TRUE, eval=TRUE, results='hold'}
load("ansM10c.RData")
ans <- ansM10c
p <- ans$pp

## segregation in atmention is larger than in follow
mat <- matrix(0,1,p)
mat[1,30] <- -1
mat[1,11] <- 1
Wald.RSiena(mat, ans)

dif <- sum(mat * ans$theta)
se <- sqrt(mat %*% ans$covtheta %*% t(mat))

print(paste("difference is", round(dif,3), "with s.e.", round(se, 3), ", t-ratio", round(dif/se, 3)))


```

Hypothesis 3b: Segregation in follow is larger than in retweet. No because...

```{r, echo=TRUE, eval=TRUE, results='hold'}
ans <- ansM10c
p <- ans$pp

## segregation in atmention is larger than in follow
mat <- matrix(0,1,p)
mat[1,11] <- -1
mat[1,50] <- 1
Wald.RSiena(mat, ans)

dif <- sum(mat * ans$theta)
se <- sqrt(mat %*% ans$covtheta %*% t(mat))

print(paste("difference is", round(dif,3), "with s.e.", round(se, 3), ", t-ratio", round(dif/se, 3)))

```

Segregation in atmention is larger than in retweet. Yes, because...

```{r, echo=TRUE, eval=TRUE, results='hold'}
ans <- ansM10c
p <- ans$pp

## segregation in atmention is larger than in follow
mat <- matrix(0,1,p)
mat[1,30] <- -1
mat[1,50] <- 1
Wald.RSiena(mat, ans)

dif <- sum(mat * ans$theta)
se <- sqrt(mat %*% ans$covtheta %*% t(mat))

print(paste("difference is", round(dif,3), "with s.e.", round(se, 3), ", t-ratio", round(dif/se, 3)))

```

---  


## Based on Model 3 


Hypothesis 3a: Segregation in atmention is larger than in follow. No/YES because...

```{r, echo=TRUE, eval=TRUE, results='hold'}
load("ansM12.RData")
ans <- ansM12
p <- ans$pp

## segregation in atmention is larger than in follow
mat <- matrix(0,1,p)
mat[1,32] <- -1
mat[1,11] <- 1
Wald.RSiena(mat, ans)

dif <- sum(mat * ans$theta)
se <- sqrt(mat %*% ans$covtheta %*% t(mat))

print(paste("difference is", round(dif,3), "with s.e.", round(se, 3), ", t-ratio", round(dif/se, 3)))


```

Hypothesis 3b: Segregation in follow is larger than in retweet. No because...

```{r, echo=TRUE, eval=TRUE, results='hold'}
ans <- ansM12
p <- ans$pp

## segregation in atmention is larger than in follow
mat <- matrix(0,1,p)
mat[1,11] <- -1
mat[1,52] <- 1
Wald.RSiena(mat, ans)

dif <- sum(mat * ans$theta)
se <- sqrt(mat %*% ans$covtheta %*% t(mat))

print(paste("difference is", round(dif,3), "with s.e.", round(se, 3), ", t-ratio", round(dif/se, 3)))

```

Segregation in atmention is larger than in retweet. Yes, because...

```{r, echo=TRUE, eval=TRUE, results='hold'}
ans <- ansM12
p <- ans$pp

## segregation in atmention is larger than in follow
mat <- matrix(0,1,p)
mat[1,30] <- -1
mat[1,50] <- 1
Wald.RSiena(mat, ans)

dif <- sum(mat * ans$theta)
se <- sqrt(mat %*% ans$covtheta %*% t(mat))

print(paste("difference is", round(dif,3), "with s.e.", round(se, 3), ", t-ratio", round(dif/se, 3)))

```


---  

# Time heterogeneity  in same party effect {.tabset .tabset-fade}

## Empty model 


```{r, echo=TRUE}

myeff <- getEffects( mydata )
myeff_m0 <- myeff

myeff_m0 <- includeEffects(myeff_m0, sameX, interaction1 = "partij", name="fnet" )
myeff_m0 <- includeEffects(myeff_m0, sameX, interaction1 = "partij", name="rtnet" )
myeff_m0 <- includeEffects(myeff_m0, sameX, interaction1 = "partij", name="atmnet" )

#remove reciprocity
myeff_m0 <- includeEffects(myeff_m0, recip, name="fnet", include = FALSE)
myeff_m0 <- includeEffects(myeff_m0, recip, name="rtnet", include = FALSE)
myeff_m0 <- includeEffects(myeff_m0, recip, name="atmnet", include = FALSE)
myeff_m0

#include the time interactions
myeff_m0 <- includeTimeDummy(myeff_m0, sameX, interaction1 = "partij", name="fnet", timeDummy="2")
myeff_m0 <- includeTimeDummy(myeff_m0, sameX, interaction1 = "partij", name="atmnet", timeDummy="2")
myeff_m0 <- includeTimeDummy(myeff_m0, sameX, interaction1 = "partij", name="rtnet", timeDummy="2")
myeff_m0

#estimates
myalgorithm <- sienaAlgorithmCreate( projname = 'M0')
ansM0 <- siena07( myalgorithm, data = mydata, effects = myeff_m0, useCluster=TRUE, nbrNodes=4, initC=TRUE, batch=TRUE)
ansM0

save(ansM0, file=paste("ansM0",".RData",sep=""))

```  

```{r, eval=TRUE}

load("ansM0.RData")
ansM0

```


## Model 1 {.active}

```{r, echo=TRUE, eval=TRUE}
load("ansM8c.RData")


tt <- sienaTimeTest(ansM8c,  effects=c(11,24,41))
#tt
#tt$EffectTest
#tt$IndividualTest
plot(tt)

```


```{r, echo=TRUE}

myeff_t <- myeff_m2

myeff_t <- includeTimeDummy(myeff_t, sameX, interaction1 = "partij", name="fnet", timeDummy="2")
myeff_t <- includeTimeDummy(myeff_t, sameX, interaction1 = "partij", name="atmnet", timeDummy="2")
myeff_t <- includeTimeDummy(myeff_t, sameX, interaction1 = "partij", name="rtnet", timeDummy="2")
myeff_t

myalgorithm <- sienaAlgorithmCreate( projname = 'M8c_t', nsub=5, n3=5000 )
ansM8c_t <- siena07( myalgorithm, data = mydata, prevAns=ansM8c, effects = myeff_t, useCluster=TRUE, nbrNodes=10, initC=TRUE, batch=TRUE)
ansM8c_t 
save(ansM8c_t, file=paste("ansM8c_t",".RData",sep=""))
``` 

```{r, echo=TRUE, eval=TRUE}

load("ansM8c_t.RData")	
#xtable.sienaFit(ansM8c_t, file="ansM8c_t.html", type="html", digits=3)


res <- round(fanscsv(ansM8c_t)[c(11,16,26,34,45,53), 1:2],5)

mc <- as.character(round(fanscsv(ansM8c_t)[54,1],3))

row.names(res) <- c(
 "same party (dyad)"  ,      
 "time*same party"   ,     
 "same party (dyad)"  ,      
 "time*same party"   ,     
 "same party (dyad)"  ,      
 "time*same party"   
)
  
M4 <- kbl(res, booktabs=TRUE, digits=3, caption="Model 4", align = "c") %>%
  kable_classic(full_width = F, html_font = "Cambria") %>%
  kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive")) %>%
  column_spec(column = 1, width = "3in")   %>%
  #row_spec(c(11, 24,41), bold = T, color = "white", background = "#D7261E") %>%
  group_rows(index = c("Following" = 2, "Atmention" = 2, "Retweets" = 2)) %>%
  footnote(general = paste("Overall maximum convergence ratio: ", mc, sep="" ))


M4

```

---  

## Model 2  

```{r, eval=TRUE}
load("ansM10c.RData")

tt <- sienaTimeTest(ansM10c,  effects=c(11,30,50))

plot(tt)
```

---  


## Model 3


```{r, eval=TRUE}
load("ansM12.RData")

tt <- sienaTimeTest(ansM12,  effects=c(11,32,52))

plot(tt)

```


---  





# References  

